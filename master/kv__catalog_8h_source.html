<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Storage Engine API: /home/louis/git/mongo/src/mongo/db/storage/kv/kv_catalog.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link href="mongodb.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="mongodb-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Storage Engine API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('kv__catalog_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">kv_catalog.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="kv__catalog_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// kv_catalog.h</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;mongo/base/string_data.h&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="collection__options_8h.html">mongo/db/catalog/collection_options.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;mongo/db/record_id.h&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="bson__collection__catalog__entry_8h.html">mongo/db/storage/bson_collection_catalog_entry.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kv__prefix_8h.html">mongo/db/storage/kv/kv_prefix.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;mongo/stdx/mutex.h&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemongo.html">mongo</a> {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">class </span>OperationContext;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">class </span>RecordStore;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html">   49</a></span>&#160;<span class="keyword">class </span><a class="code" href="classmongo_1_1KVCatalog.html">KVCatalog</a> {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">class </span><a class="code" href="classmongo_1_1KVCatalog_1_1FeatureTracker.html">FeatureTracker</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="classmongo_1_1KVCatalog.html#a35ba090cce30b3501b4e661b47b17667">KVCatalog</a>(<a class="code" href="classmongo_1_1RecordStore.html">RecordStore</a>* <a class="code" href="kv__engine__test__timestamps_8cpp.html#ace772d9f1f47f28930b20743f0415276">rs</a>, <span class="keywordtype">bool</span> directoryPerDb, <span class="keywordtype">bool</span> directoryForIndexes);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classmongo_1_1KVCatalog.html#afa8a93754539ed2eb6a2a54cbfda59c6">~KVCatalog</a>();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classmongo_1_1KVCatalog.html#a215269e3ea321d01bc51dcb19d0670cd">init</a>(OperationContext* <a class="code" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classmongo_1_1KVCatalog.html#a0b35957a2b1d90bd93e96bc0cdb66d23">getAllCollections</a>(std::vector&lt;std::string&gt;* out) <span class="keyword">const</span>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> <a class="code" href="classmongo_1_1KVCatalog.html#a0402949a59325e6dda50c04b0fd45d95">newCollection</a>(OperationContext* opCtx,</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                         StringData <a class="code" href="namespacemongo.html#aa1aad236ca83643ab0718062dd62f4fc">ns</a>,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                         <span class="keyword">const</span> <a class="code" href="structmongo_1_1CollectionOptions.html">CollectionOptions</a>&amp; <a class="code" href="namespacemongo.html#ad271b77bcd8d56d7a7e2205e9cb55df7">options</a>,</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                         <a class="code" href="classmongo_1_1KVPrefix.html">KVPrefix</a> prefix);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    std::string <a class="code" href="classmongo_1_1KVCatalog.html#a2c6da7324741c5c23d18b0d843f0c112">getCollectionIdent</a>(StringData ns) <span class="keyword">const</span>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    std::string <a class="code" href="classmongo_1_1KVCatalog.html#a8ac0d5c7128331b4066eb1564af4b115">getIndexIdent</a>(OperationContext* opCtx, StringData ns, StringData idName) <span class="keyword">const</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="structmongo_1_1BSONCollectionCatalogEntry_1_1MetaData.html">BSONCollectionCatalogEntry::MetaData</a> <a class="code" href="classmongo_1_1KVCatalog.html#a7884e86aac1cde5bd476acded7f305ec">getMetaData</a>(OperationContext* opCtx, StringData ns) <span class="keyword">const</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classmongo_1_1KVCatalog.html#a57c2767bb468864c73443dea747459e1">putMetaData</a>(OperationContext* opCtx,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                     StringData ns,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                     <a class="code" href="structmongo_1_1BSONCollectionCatalogEntry_1_1MetaData.html">BSONCollectionCatalogEntry::MetaData</a>&amp; md);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> <a class="code" href="classmongo_1_1KVCatalog.html#a076c07f17c0aef56a2e48a208ad1bef2">renameCollection</a>(OperationContext* opCtx,</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                            StringData fromNS,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                            StringData toNS,</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                            <span class="keywordtype">bool</span> stayTemp);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> <a class="code" href="classmongo_1_1KVCatalog.html#a88a2a081bfb9b927db2325d30f57cf87">dropCollection</a>(OperationContext* opCtx, StringData ns);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    std::vector&lt;std::string&gt; <a class="code" href="classmongo_1_1KVCatalog.html#a8340a2c8cb237e8319f638a6b70989ef">getAllIdentsForDB</a>(StringData <a class="code" href="namespacemongo.html#a4ae6ca2f1e345dcee0a3bf19089f12f0">db</a>) <span class="keyword">const</span>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    std::vector&lt;std::string&gt; <a class="code" href="classmongo_1_1KVCatalog.html#a29933f63e7d4c7407efd4c97dc9ab80d">getAllIdents</a>(OperationContext* opCtx) <span class="keyword">const</span>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classmongo_1_1KVCatalog.html#ad50e184fae9fc90e0709d1e08cca79a4">isUserDataIdent</a>(StringData ident) <span class="keyword">const</span>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#a928fc2b837801ff840f5ab87f267afbb">   95</a></span>&#160;    <a class="code" href="classmongo_1_1KVCatalog_1_1FeatureTracker.html">FeatureTracker</a>* <a class="code" href="classmongo_1_1KVCatalog.html#a928fc2b837801ff840f5ab87f267afbb">getFeatureTracker</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        invariant(<a class="code" href="classmongo_1_1KVCatalog.html#afa9880b497191934fa3be076da548def">_featureTracker</a>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmongo_1_1KVCatalog.html#afa9880b497191934fa3be076da548def">_featureTracker</a>.get();</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#aa70b2fd534465ba65d756248b7bbe9d3">  100</a></span>&#160;    <a class="code" href="classmongo_1_1RecordStore.html">RecordStore</a>* <a class="code" href="classmongo_1_1KVCatalog.html#aa70b2fd534465ba65d756248b7bbe9d3">getRecordStore</a>() {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmongo_1_1KVCatalog.html#aba168d36c553a536a542af09bdd1e6fc">_rs</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">class </span><a class="code" href="classmongo_1_1KVCatalog_1_1AddIdentChange.html">AddIdentChange</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">class </span><a class="code" href="classmongo_1_1KVCatalog_1_1RemoveIdentChange.html">RemoveIdentChange</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    BSONObj <a class="code" href="classmongo_1_1KVCatalog.html#adbd9373899a10e7c50ab96ac24bec355">_findEntry</a>(OperationContext* opCtx, StringData ns, RecordId* out = NULL) <span class="keyword">const</span>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    std::string <a class="code" href="classmongo_1_1KVCatalog.html#aaca8b3445dd1aa3870fc655285e1ec9e">_newUniqueIdent</a>(StringData ns, <span class="keyword">const</span> <span class="keywordtype">char</span>* kind);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// Helpers only used by constructor and init(). Don&#39;t call from elsewhere.</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keyword">static</span> std::string <a class="code" href="classmongo_1_1KVCatalog.html#a17b4140725b413449e5db74ddb0a7429">_newRand</a>();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classmongo_1_1KVCatalog.html#a9c158c2e57d2ebd553fa7835a4742065">_hasEntryCollidingWithRand</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#aba168d36c553a536a542af09bdd1e6fc">  121</a></span>&#160;    <a class="code" href="classmongo_1_1RecordStore.html">RecordStore</a>* <a class="code" href="classmongo_1_1KVCatalog.html#aba168d36c553a536a542af09bdd1e6fc">_rs</a>;  <span class="comment">// not owned</span></div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#a68fae4f1cf54356e33d6ea535b0b31d5">  122</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classmongo_1_1KVCatalog.html#a68fae4f1cf54356e33d6ea535b0b31d5">_directoryPerDb</a>;</div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#a904975ec97832175203e2ddcadb5f133">  123</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classmongo_1_1KVCatalog.html#a904975ec97832175203e2ddcadb5f133">_directoryForIndexes</a>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// These two are only used for ident generation inside _newUniqueIdent.</span></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#a6ab73f0148ea34a877b11a6bedc06ab8">  126</a></span>&#160;    std::string <a class="code" href="classmongo_1_1KVCatalog.html#a6ab73f0148ea34a877b11a6bedc06ab8">_rand</a>;  <span class="comment">// effectively const after init() returns</span></div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#ac94e252523c2fb368325b2491a5414b6">  127</a></span>&#160;    AtomicUInt64 <a class="code" href="classmongo_1_1KVCatalog.html#ac94e252523c2fb368325b2491a5414b6">_next</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structmongo_1_1KVCatalog_1_1Entry.html">  129</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structmongo_1_1KVCatalog_1_1Entry.html">Entry</a> {</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structmongo_1_1KVCatalog_1_1Entry.html#a94de20c8178651028c358a76250e05d4">  130</a></span>&#160;        <a class="code" href="structmongo_1_1KVCatalog_1_1Entry.html#a94de20c8178651028c358a76250e05d4">Entry</a>() {}</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="structmongo_1_1KVCatalog_1_1Entry.html#a9fda198b7798ac151780f0f803248650">  131</a></span>&#160;        <a class="code" href="structmongo_1_1KVCatalog_1_1Entry.html#a9fda198b7798ac151780f0f803248650">Entry</a>(std::string i, RecordId l) : ident(i), <a class="code" href="structmongo_1_1KVCatalog_1_1Entry.html#a4cab13bd12785964f190d7a0d9f29638">storedLoc</a>(l) {}</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="structmongo_1_1KVCatalog_1_1Entry.html#ab5ba67a025f4e3646200e5089051ad8e">  132</a></span>&#160;        std::string <a class="code" href="structmongo_1_1KVCatalog_1_1Entry.html#ab5ba67a025f4e3646200e5089051ad8e">ident</a>;</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structmongo_1_1KVCatalog_1_1Entry.html#a4cab13bd12785964f190d7a0d9f29638">  133</a></span>&#160;        RecordId <a class="code" href="structmongo_1_1KVCatalog_1_1Entry.html#a4cab13bd12785964f190d7a0d9f29638">storedLoc</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    };</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#ae5fbf99864bdbaeb2cd206088bcbd1d2">  135</a></span>&#160;    <span class="keyword">typedef</span> std::map&lt;std::string, Entry&gt; <a class="code" href="classmongo_1_1KVCatalog.html#ae5fbf99864bdbaeb2cd206088bcbd1d2">NSToIdentMap</a>;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#a655810a17c9db69e50140a3a183233fe">  136</a></span>&#160;    NSToIdentMap <a class="code" href="classmongo_1_1KVCatalog.html#a655810a17c9db69e50140a3a183233fe">_idents</a>;</div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#a0f906115087fd4629daeaa75f2f3e7e5">  137</a></span>&#160;    <span class="keyword">mutable</span> stdx::mutex <a class="code" href="classmongo_1_1KVCatalog.html#a0f906115087fd4629daeaa75f2f3e7e5">_identsLock</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// Manages the feature document that may be present in the KVCatalog. &#39;_featureTracker&#39; is</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// guaranteed to be non-null after KVCatalog::init() is called.</span></div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classmongo_1_1KVCatalog.html#afa9880b497191934fa3be076da548def">  141</a></span>&#160;    std::unique_ptr&lt;FeatureTracker&gt; <a class="code" href="classmongo_1_1KVCatalog.html#afa9880b497191934fa3be076da548def">_featureTracker</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;};</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div><div class="ttc" id="classmongo_1_1KVCatalog_html_ae5fbf99864bdbaeb2cd206088bcbd1d2"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#ae5fbf99864bdbaeb2cd206088bcbd1d2">mongo::KVCatalog::NSToIdentMap</a></div><div class="ttdeci">std::map&lt; std::string, Entry &gt; NSToIdentMap</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:135</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_aa70b2fd534465ba65d756248b7bbe9d3"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#aa70b2fd534465ba65d756248b7bbe9d3">mongo::KVCatalog::getRecordStore</a></div><div class="ttdeci">RecordStore * getRecordStore()</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:100</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a35ba090cce30b3501b4e661b47b17667"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a35ba090cce30b3501b4e661b47b17667">mongo::KVCatalog::KVCatalog</a></div><div class="ttdeci">KVCatalog(RecordStore *rs, bool directoryPerDb, bool directoryForIndexes)</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:324</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_ad50e184fae9fc90e0709d1e08cca79a4"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#ad50e184fae9fc90e0709d1e08cca79a4">mongo::KVCatalog::isUserDataIdent</a></div><div class="ttdeci">bool isUserDataIdent(StringData ident) const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:630</div></div>
<div class="ttc" id="namespacemongo_html_aa1aad236ca83643ab0718062dd62f4fc"><div class="ttname"><a href="namespacemongo.html#aa1aad236ca83643ab0718062dd62f4fc">mongo::ns</a></div><div class="ttdeci">Collection *const const NamespaceString &amp; ns</div><div class="ttdef"><b>Definition:</b> collection_info_cache_impl.cpp:53</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a17b4140725b413449e5db74ddb0a7429"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a17b4140725b413449e5db74ddb0a7429">mongo::KVCatalog::_newRand</a></div><div class="ttdeci">static std::string _newRand()</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:334</div></div>
<div class="ttc" id="structmongo_1_1CollectionOptions_html"><div class="ttname"><a href="structmongo_1_1CollectionOptions.html">mongo::CollectionOptions</a></div><div class="ttdef"><b>Definition:</b> collection_options.h:57</div></div>
<div class="ttc" id="namespacemongo_html"><div class="ttname"><a href="namespacemongo.html">mongo</a></div><div class="ttdoc">Copyright (C) 2014 MongoDB Inc. </div><div class="ttdef"><b>Definition:</b> bson_collection_catalog_entry.cpp:38</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_aba168d36c553a536a542af09bdd1e6fc"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#aba168d36c553a536a542af09bdd1e6fc">mongo::KVCatalog::_rs</a></div><div class="ttdeci">RecordStore * _rs</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:121</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a6ab73f0148ea34a877b11a6bedc06ab8"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a6ab73f0148ea34a877b11a6bedc06ab8">mongo::KVCatalog::_rand</a></div><div class="ttdeci">std::string _rand</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:126</div></div>
<div class="ttc" id="namespacemongo_html_a7dd53a44ec884164bc07ed073e9f31da"><div class="ttname"><a href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">mongo::Status</a></div><div class="ttdeci">OperationContext Database StringData BSONObj CollectionOptions::ParseKind bool const BSONObj &amp;idIndex Status</div><div class="ttdef"><b>Definition:</b> database_impl.cpp:956</div></div>
<div class="ttc" id="collection__options_8h_html"><div class="ttname"><a href="collection__options_8h.html">collection_options.h</a></div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a928fc2b837801ff840f5ab87f267afbb"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a928fc2b837801ff840f5ab87f267afbb">mongo::KVCatalog::getFeatureTracker</a></div><div class="ttdeci">FeatureTracker * getFeatureTracker() const</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:95</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a215269e3ea321d01bc51dcb19d0670cd"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a215269e3ea321d01bc51dcb19d0670cd">mongo::KVCatalog::init</a></div><div class="ttdeci">void init(OperationContext *opCtx)</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:359</div></div>
<div class="ttc" id="bson__collection__catalog__entry_8h_html"><div class="ttname"><a href="bson__collection__catalog__entry_8h.html">bson_collection_catalog_entry.h</a></div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a88a2a081bfb9b927db2325d30f57cf87"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a88a2a081bfb9b927db2325d30f57cf87">mongo::KVCatalog::dropCollection</a></div><div class="ttdeci">Status dropCollection(OperationContext *opCtx, StringData ns)</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:569</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a9c158c2e57d2ebd553fa7835a4742065"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a9c158c2e57d2ebd553fa7835a4742065">mongo::KVCatalog::_hasEntryCollidingWithRand</a></div><div class="ttdeci">bool _hasEntryCollidingWithRand() const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:338</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a57c2767bb468864c73443dea747459e1"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a57c2767bb468864c73443dea747459e1">mongo::KVCatalog::putMetaData</a></div><div class="ttdeci">void putMetaData(OperationContext *opCtx, StringData ns, BSONCollectionCatalogEntry::MetaData &amp;md)</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:492</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_afa9880b497191934fa3be076da548def"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#afa9880b497191934fa3be076da548def">mongo::KVCatalog::_featureTracker</a></div><div class="ttdeci">std::unique_ptr&lt; FeatureTracker &gt; _featureTracker</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:141</div></div>
<div class="ttc" id="kv__engine__test__timestamps_8cpp_html_ace772d9f1f47f28930b20743f0415276"><div class="ttname"><a href="kv__engine__test__timestamps_8cpp.html#ace772d9f1f47f28930b20743f0415276">rs</a></div><div class="ttdeci">std::unique_ptr&lt; RecordStore &gt; rs</div><div class="ttdef"><b>Definition:</b> kv_engine_test_timestamps.cpp:207</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a8340a2c8cb237e8319f638a6b70989ef"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a8340a2c8cb237e8319f638a6b70989ef">mongo::KVCatalog::getAllIdentsForDB</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getAllIdentsForDB(StringData db) const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:586</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html"><div class="ttname"><a href="classmongo_1_1KVCatalog.html">mongo::KVCatalog</a></div><div class="ttdef"><b>Definition:</b> kv_catalog.h:49</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a904975ec97832175203e2ddcadb5f133"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a904975ec97832175203e2ddcadb5f133">mongo::KVCatalog::_directoryForIndexes</a></div><div class="ttdeci">const bool _directoryForIndexes</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:123</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a8ac0d5c7128331b4066eb1564af4b115"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a8ac0d5c7128331b4066eb1564af4b115">mongo::KVCatalog::getIndexIdent</a></div><div class="ttdeci">std::string getIndexIdent(OperationContext *opCtx, StringData ns, StringData idName) const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:447</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_ac94e252523c2fb368325b2491a5414b6"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#ac94e252523c2fb368325b2491a5414b6">mongo::KVCatalog::_next</a></div><div class="ttdeci">AtomicUInt64 _next</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:127</div></div>
<div class="ttc" id="structmongo_1_1KVCatalog_1_1Entry_html_a94de20c8178651028c358a76250e05d4"><div class="ttname"><a href="structmongo_1_1KVCatalog_1_1Entry.html#a94de20c8178651028c358a76250e05d4">mongo::KVCatalog::Entry::Entry</a></div><div class="ttdeci">Entry()</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:130</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a68fae4f1cf54356e33d6ea535b0b31d5"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a68fae4f1cf54356e33d6ea535b0b31d5">mongo::KVCatalog::_directoryPerDb</a></div><div class="ttdeci">const bool _directoryPerDb</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:122</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a0f906115087fd4629daeaa75f2f3e7e5"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a0f906115087fd4629daeaa75f2f3e7e5">mongo::KVCatalog::_identsLock</a></div><div class="ttdeci">stdx::mutex _identsLock</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:137</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_1_1RemoveIdentChange_html"><div class="ttname"><a href="classmongo_1_1KVCatalog_1_1RemoveIdentChange.html">mongo::KVCatalog::RemoveIdentChange</a></div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:152</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_aaca8b3445dd1aa3870fc655285e1ec9e"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#aaca8b3445dd1aa3870fc655285e1ec9e">mongo::KVCatalog::_newUniqueIdent</a></div><div class="ttdeci">std::string _newUniqueIdent(StringData ns, const char *kind)</div><div class="ttdoc">Generates a new unique identifier for a new &quot;thing&quot;. </div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:347</div></div>
<div class="ttc" id="structmongo_1_1KVCatalog_1_1Entry_html_a9fda198b7798ac151780f0f803248650"><div class="ttname"><a href="structmongo_1_1KVCatalog_1_1Entry.html#a9fda198b7798ac151780f0f803248650">mongo::KVCatalog::Entry::Entry</a></div><div class="ttdeci">Entry(std::string i, RecordId l)</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:131</div></div>
<div class="ttc" id="structmongo_1_1KVCatalog_1_1Entry_html_ab5ba67a025f4e3646200e5089051ad8e"><div class="ttname"><a href="structmongo_1_1KVCatalog_1_1Entry.html#ab5ba67a025f4e3646200e5089051ad8e">mongo::KVCatalog::Entry::ident</a></div><div class="ttdeci">std::string ident</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:132</div></div>
<div class="ttc" id="classmongo_1_1RecordStore_html"><div class="ttname"><a href="classmongo_1_1RecordStore.html">mongo::RecordStore</a></div><div class="ttdoc">An abstraction used for storing documents in a collection or entries in an index. ...</div><div class="ttdef"><b>Definition:</b> record_store.h:282</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a0b35957a2b1d90bd93e96bc0cdb66d23"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a0b35957a2b1d90bd93e96bc0cdb66d23">mongo::KVCatalog::getAllCollections</a></div><div class="ttdeci">void getAllCollections(std::vector&lt; std::string &gt; *out) const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:393</div></div>
<div class="ttc" id="structmongo_1_1KVCatalog_1_1Entry_html_a4cab13bd12785964f190d7a0d9f29638"><div class="ttname"><a href="structmongo_1_1KVCatalog_1_1Entry.html#a4cab13bd12785964f190d7a0d9f29638">mongo::KVCatalog::Entry::storedLoc</a></div><div class="ttdeci">RecordId storedLoc</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:133</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a0402949a59325e6dda50c04b0fd45d95"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a0402949a59325e6dda50c04b0fd45d95">mongo::KVCatalog::newCollection</a></div><div class="ttdeci">Status newCollection(OperationContext *opCtx, StringData ns, const CollectionOptions &amp;options, KVPrefix prefix)</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:400</div></div>
<div class="ttc" id="namespacemongo_html_a4ae6ca2f1e345dcee0a3bf19089f12f0"><div class="ttname"><a href="namespacemongo.html#a4ae6ca2f1e345dcee0a3bf19089f12f0">mongo::db</a></div><div class="ttdeci">OperationContext Database * db</div><div class="ttdef"><b>Definition:</b> database_impl.cpp:949</div></div>
<div class="ttc" id="namespacemongo_html_ad271b77bcd8d56d7a7e2205e9cb55df7"><div class="ttname"><a href="namespacemongo.html#ad271b77bcd8d56d7a7e2205e9cb55df7">mongo::options</a></div><div class="ttdeci">OperationContext Database StringData BSONObj options</div><div class="ttdef"><b>Definition:</b> database_impl.cpp:949</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_1_1FeatureTracker_html"><div class="ttname"><a href="classmongo_1_1KVCatalog_1_1FeatureTracker.html">mongo::KVCatalog::FeatureTracker</a></div><div class="ttdoc">Manages the contents of a document in the KVCatalog used to restrict downgrade compatibility. </div><div class="ttdef"><b>Definition:</b> kv_catalog_feature_tracker.h:53</div></div>
<div class="ttc" id="classmongo_1_1KVPrefix_html"><div class="ttname"><a href="classmongo_1_1KVPrefix.html">mongo::KVPrefix</a></div><div class="ttdoc">A KVPrefix may be prepended to the keys of entries in an underlying KV store. </div><div class="ttdef"><b>Definition:</b> kv_prefix.h:44</div></div>
<div class="ttc" id="structmongo_1_1KVCatalog_1_1Entry_html"><div class="ttname"><a href="structmongo_1_1KVCatalog_1_1Entry.html">mongo::KVCatalog::Entry</a></div><div class="ttdef"><b>Definition:</b> kv_catalog.h:129</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a7884e86aac1cde5bd476acded7f305ec"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a7884e86aac1cde5bd476acded7f305ec">mongo::KVCatalog::getMetaData</a></div><div class="ttdeci">BSONCollectionCatalogEntry::MetaData getMetaData(OperationContext *opCtx, StringData ns) const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:479</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a655810a17c9db69e50140a3a183233fe"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a655810a17c9db69e50140a3a183233fe">mongo::KVCatalog::_idents</a></div><div class="ttdeci">NSToIdentMap _idents</div><div class="ttdef"><b>Definition:</b> kv_catalog.h:136</div></div>
<div class="ttc" id="namespacemongo_html_a15b23ef1d9a7f6cdadbf866f1e8e5043"><div class="ttname"><a href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">mongo::opCtx</a></div><div class="ttdeci">Collection *const OperationContext *const opCtx</div><div class="ttdef"><b>Definition:</b> collection_impl.cpp:80</div></div>
<div class="ttc" id="structmongo_1_1BSONCollectionCatalogEntry_1_1MetaData_html"><div class="ttname"><a href="structmongo_1_1BSONCollectionCatalogEntry_1_1MetaData.html">mongo::BSONCollectionCatalogEntry::MetaData</a></div><div class="ttdef"><b>Definition:</b> bson_collection_catalog_entry.h:110</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_1_1AddIdentChange_html"><div class="ttname"><a href="classmongo_1_1KVCatalog_1_1AddIdentChange.html">mongo::KVCatalog::AddIdentChange</a></div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:137</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a076c07f17c0aef56a2e48a208ad1bef2"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a076c07f17c0aef56a2e48a208ad1bef2">mongo::KVCatalog::renameCollection</a></div><div class="ttdeci">Status renameCollection(OperationContext *opCtx, StringData fromNS, StringData toNS, bool stayTemp)</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:531</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a2c6da7324741c5c23d18b0d843f0c112"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a2c6da7324741c5c23d18b0d843f0c112">mongo::KVCatalog::getCollectionIdent</a></div><div class="ttdeci">std::string getCollectionIdent(StringData ns) const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:440</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_a29933f63e7d4c7407efd4c97dc9ab80d"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#a29933f63e7d4c7407efd4c97dc9ab80d">mongo::KVCatalog::getAllIdents</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getAllIdents(OperationContext *opCtx) const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:602</div></div>
<div class="ttc" id="kv__prefix_8h_html"><div class="ttname"><a href="kv__prefix_8h.html">kv_prefix.h</a></div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_afa8a93754539ed2eb6a2a54cbfda59c6"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#afa8a93754539ed2eb6a2a54cbfda59c6">mongo::KVCatalog::~KVCatalog</a></div><div class="ttdeci">~KVCatalog()</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:330</div></div>
<div class="ttc" id="classmongo_1_1KVCatalog_html_adbd9373899a10e7c50ab96ac24bec355"><div class="ttname"><a href="classmongo_1_1KVCatalog.html#adbd9373899a10e7c50ab96ac24bec355">mongo::KVCatalog::_findEntry</a></div><div class="ttdeci">BSONObj _findEntry(OperationContext *opCtx, StringData ns, RecordId *out=NULL) const</div><div class="ttdef"><b>Definition:</b> kv_catalog.cpp:455</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_dd1d225638daf3f3753df6d6ceaf954c.html">mongo</a></li><li class="navelem"><a class="el" href="dir_68cd4a12641825290eb1b2d05c12b4ee.html">db</a></li><li class="navelem"><a class="el" href="dir_c84aae0d5ddd3c0a024c539b5e839913.html">storage</a></li><li class="navelem"><a class="el" href="dir_bbd300dc49cf093b855349b965a2a49b.html">kv</a></li><li class="navelem"><a class="el" href="kv__catalog_8h.html">kv_catalog.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
