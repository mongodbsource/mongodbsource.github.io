<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Storage Engine API: mongo::dur::DurableInterface Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link href="mongodb.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="mongodb-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Storage Engine API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classmongo_1_1dur_1_1DurableInterface.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classmongo_1_1dur_1_1DurableInterface-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mongo::dur::DurableInterface Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="dur_8h_source.html">dur.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5f7b7a103e61c49b6131a503f7535e27"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a5f7b7a103e61c49b6131a503f7535e27">~DurableInterface</a> ()</td></tr>
<tr class="separator:a5f7b7a103e61c49b6131a503f7535e27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ac3a95a083f1c6d75b6c674449263e0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a6ac3a95a083f1c6d75b6c674449263e0">createdFile</a> (const std::string &amp;filename, unsigned long long len)=0</td></tr>
<tr class="memdesc:a6ac3a95a083f1c6d75b6c674449263e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare that a file has been created.  <a href="#a6ac3a95a083f1c6d75b6c674449263e0">More...</a><br /></td></tr>
<tr class="separator:a6ac3a95a083f1c6d75b6c674449263e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a127702d90ec4843eec5310d1af6863ee"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a127702d90ec4843eec5310d1af6863ee">declareWriteIntents</a> (const std::vector&lt; std::pair&lt; <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> *, unsigned &gt;&gt; &amp;intents)=0</td></tr>
<tr class="separator:a127702d90ec4843eec5310d1af6863ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace99eb2d2794e5ad6981363c02dc18ab"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#ace99eb2d2794e5ad6981363c02dc18ab">waitUntilDurable</a> ()=0</td></tr>
<tr class="memdesc:ace99eb2d2794e5ad6981363c02dc18ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for acknowledgement of the next group commit.  <a href="#ace99eb2d2794e5ad6981363c02dc18ab">More...</a><br /></td></tr>
<tr class="separator:ace99eb2d2794e5ad6981363c02dc18ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac73c56e4a90091bfe83a3f78ca902136"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#ac73c56e4a90091bfe83a3f78ca902136">commitNow</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)=0</td></tr>
<tr class="memdesc:ac73c56e4a90091bfe83a3f78ca902136"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commit immediately.  <a href="#ac73c56e4a90091bfe83a3f78ca902136">More...</a><br /></td></tr>
<tr class="separator:ac73c56e4a90091bfe83a3f78ca902136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f51e178046d5696c0d3cf4e7884a3ca"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a6f51e178046d5696c0d3cf4e7884a3ca">commitIfNeeded</a> ()=0</td></tr>
<tr class="memdesc:a6f51e178046d5696c0d3cf4e7884a3ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commit if enough bytes have been modified.  <a href="#a6f51e178046d5696c0d3cf4e7884a3ca">More...</a><br /></td></tr>
<tr class="separator:a6f51e178046d5696c0d3cf4e7884a3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad244f7aee30d8b0eba3c934b2846f30b"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#ad244f7aee30d8b0eba3c934b2846f30b">closingFileNotification</a> ()=0</td></tr>
<tr class="memdesc:ad244f7aee30d8b0eba3c934b2846f30b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a <a class="el" href="classmongo_1_1DurableMappedFile.html" title="DurableMappedFile adds some layers atop memory mapped files - specifically our handling of private vi...">DurableMappedFile</a> is closing.  <a href="#ad244f7aee30d8b0eba3c934b2846f30b">More...</a><br /></td></tr>
<tr class="separator:ad244f7aee30d8b0eba3c934b2846f30b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1791f70f93c7b62e42330911a6487bb0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a1791f70f93c7b62e42330911a6487bb0">commitAndStopDurThread</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)=0</td></tr>
<tr class="memdesc:a1791f70f93c7b62e42330911a6487bb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invoked at clean shutdown time.  <a href="#a1791f70f93c7b62e42330911a6487bb0">More...</a><br /></td></tr>
<tr class="separator:a1791f70f93c7b62e42330911a6487bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a602b2b630aceef70c84cab67e145a312"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a602b2b630aceef70c84cab67e145a312">syncDataAndTruncateJournal</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)=0</td></tr>
<tr class="memdesc:a602b2b630aceef70c84cab67e145a312"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commits pending changes, flushes all changes to main data files, then removes the journal.  <a href="#a602b2b630aceef70c84cab67e145a312">More...</a><br /></td></tr>
<tr class="separator:a602b2b630aceef70c84cab67e145a312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1947abbb195b15b9f1bd282c318a7146"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a1947abbb195b15b9f1bd282c318a7146">isDurable</a> () const =0</td></tr>
<tr class="separator:a1947abbb195b15b9f1bd282c318a7146"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a45a0239f5e6996b297318d6f1ba8c540"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmongo_1_1dur_1_1DurableInterface.html">DurableInterface</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a45a0239f5e6996b297318d6f1ba8c540">getDur</a> ()</td></tr>
<tr class="separator:a45a0239f5e6996b297318d6f1ba8c540"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a0b9af44abc66b407c25badfa143b8638"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a0b9af44abc66b407c25badfa143b8638">DurableInterface</a> ()</td></tr>
<tr class="separator:a0b9af44abc66b407c25badfa143b8638"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a590677ec94032a99a8cae599d6b1f833"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a590677ec94032a99a8cae599d6b1f833">MONGO_DISALLOW_COPYING</a> (<a class="el" href="classmongo_1_1dur_1_1DurableInterface.html">DurableInterface</a>)</td></tr>
<tr class="separator:a590677ec94032a99a8cae599d6b1f833"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:aea32310b97d037e37daeb1b3d4d84111"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmongo_1_1dur_1_1DurableInterface.html">DurableInterface</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#aea32310b97d037e37daeb1b3d4d84111">_impl</a></td></tr>
<tr class="separator:aea32310b97d037e37daeb1b3d4d84111"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a7e9feb0fabb69da0b74a850bd12f70d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a7e9feb0fabb69da0b74a850bd12f70d4">startup</a> (ClockSource *cs, int64_t serverStartMs)</td></tr>
<tr class="memdesc:a7e9feb0fabb69da0b74a850bd12f70d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invoked at server startup.  <a href="#a7e9feb0fabb69da0b74a850bd12f70d4">More...</a><br /></td></tr>
<tr class="separator:a7e9feb0fabb69da0b74a850bd12f70d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5f7b7a103e61c49b6131a503f7535e27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f7b7a103e61c49b6131a503f7535e27">&#9670;&nbsp;</a></span>~DurableInterface()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mongo::dur::DurableInterface::~DurableInterface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0b9af44abc66b407c25badfa143b8638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b9af44abc66b407c25badfa143b8638">&#9670;&nbsp;</a></span>DurableInterface()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mongo::dur::DurableInterface::DurableInterface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad244f7aee30d8b0eba3c934b2846f30b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad244f7aee30d8b0eba3c934b2846f30b">&#9670;&nbsp;</a></span>closingFileNotification()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::dur::DurableInterface::closingFileNotification </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called when a <a class="el" href="classmongo_1_1DurableMappedFile.html" title="DurableMappedFile adds some layers atop memory mapped files - specifically our handling of private vi...">DurableMappedFile</a> is closing. </p>
<p>Asserts that there are no unwritten changes, because that would mean journal replay on recovery would try to write to non-existent files and fail. </p>

</div>
</div>
<a id="a1791f70f93c7b62e42330911a6487bb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1791f70f93c7b62e42330911a6487bb0">&#9670;&nbsp;</a></span>commitAndStopDurThread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::dur::DurableInterface::commitAndStopDurThread </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Invoked at clean shutdown time. </p>
<p>Performs one last commit/flush and terminates the flush thread.</p>
<p>Must be called under the global X lock. </p>

</div>
</div>
<a id="a6f51e178046d5696c0d3cf4e7884a3ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f51e178046d5696c0d3cf4e7884a3ca">&#9670;&nbsp;</a></span>commitIfNeeded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::dur::DurableInterface::commitIfNeeded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Commit if enough bytes have been modified. </p>
<p>Current threshold is 50MB</p>
<p>The idea is that long running write operations that don't yield (like creating an index) can call this whenever the db is in a sane state and it will prevent commits from growing too large. </p><dl class="section return"><dt>Returns</dt><dd>true if commited </dd></dl>

</div>
</div>
<a id="ac73c56e4a90091bfe83a3f78ca902136"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac73c56e4a90091bfe83a3f78ca902136">&#9670;&nbsp;</a></span>commitNow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::dur::DurableInterface::commitNow </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Commit immediately. </p>
<p>Generally, you do not want to do this often, as highly granular committing may affect performance.</p>
<p>Does not return until the commit is complete.</p>
<p>You must be at least read locked when you call this. Ideally, you are not write locked and then read operations can occur concurrently.</p>
<p>Do not use this. Use <a class="el" href="classmongo_1_1dur_1_1DurableInterface.html#a6f51e178046d5696c0d3cf4e7884a3ca" title="Commit if enough bytes have been modified. ">commitIfNeeded()</a> instead.</p>
<dl class="section return"><dt>Returns</dt><dd>true if &ndash;dur is on. </dd>
<dd>
false if &ndash;dur is off. (in which case there is action) </dd></dl>

</div>
</div>
<a id="a6ac3a95a083f1c6d75b6c674449263e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ac3a95a083f1c6d75b6c674449263e0">&#9670;&nbsp;</a></span>createdFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::dur::DurableInterface::createdFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Declare that a file has been created. </p>
<p>Normally writes are applied only after journaling for safety. But here the file is created first, and the journal will just replay the creation if the create didn't happen due to a crash. </p>

</div>
</div>
<a id="a127702d90ec4843eec5310d1af6863ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a127702d90ec4843eec5310d1af6863ee">&#9670;&nbsp;</a></span>declareWriteIntents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::dur::DurableInterface::declareWriteIntents </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::pair&lt; <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> *, unsigned &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>intents</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a45a0239f5e6996b297318d6f1ba8c540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a0239f5e6996b297318d6f1ba8c540">&#9670;&nbsp;</a></span>getDur()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classmongo_1_1dur_1_1DurableInterface.html">DurableInterface</a>&amp; mongo::dur::DurableInterface::getDur </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1947abbb195b15b9f1bd282c318a7146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1947abbb195b15b9f1bd282c318a7146">&#9670;&nbsp;</a></span>isDurable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::dur::DurableInterface::isDurable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a590677ec94032a99a8cae599d6b1f833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a590677ec94032a99a8cae599d6b1f833">&#9670;&nbsp;</a></span>MONGO_DISALLOW_COPYING()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mongo::dur::DurableInterface::MONGO_DISALLOW_COPYING </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html">DurableInterface</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a602b2b630aceef70c84cab67e145a312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a602b2b630aceef70c84cab67e145a312">&#9670;&nbsp;</a></span>syncDataAndTruncateJournal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::dur::DurableInterface::syncDataAndTruncateJournal </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Commits pending changes, flushes all changes to main data files, then removes the journal. </p>
<p>WARNING: Data <em>must</em> be in a crash-recoverable state when this is called and must not be inside of a write unit of work.</p>
<p>This is useful as a "barrier" to ensure that writes before this call will never go through recovery and be applied to files that have had changes made after this call applied. </p>

</div>
</div>
<a id="ace99eb2d2794e5ad6981363c02dc18ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace99eb2d2794e5ad6981363c02dc18ab">&#9670;&nbsp;</a></span>waitUntilDurable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::dur::DurableInterface::waitUntilDurable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wait for acknowledgement of the next group commit. </p>
<dl class="section return"><dt>Returns</dt><dd>true if &ndash;dur is on. There will be delay. </dd>
<dd>
false if &ndash;dur is off. </dd></dl>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a7e9feb0fabb69da0b74a850bd12f70d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e9feb0fabb69da0b74a850bd12f70d4">&#9670;&nbsp;</a></span>startup</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> startup </td>
          <td>(</td>
          <td class="paramtype">ClockSource *&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>serverStartMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Invoked at server startup. </p>
<p>Called during startup to startup the durability module.</p>
<p>Recovers the database by replaying journal files and then starts the durability thread.</p>
<p>Does nothing if storageGlobalParams.dur is false </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aea32310b97d037e37daeb1b3d4d84111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea32310b97d037e37daeb1b3d4d84111">&#9670;&nbsp;</a></span>_impl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html">DurableInterface</a>* mongo::dur::DurableInterface::_impl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/louis/git/mongo/src/mongo/db/storage/mmap_v1/<a class="el" href="dur_8h_source.html">dur.h</a></li>
<li>/home/louis/git/mongo/src/mongo/db/storage/mmap_v1/<a class="el" href="dur_8cpp.html">dur.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemongo.html">mongo</a></li><li class="navelem"><a class="el" href="namespacemongo_1_1dur.html">dur</a></li><li class="navelem"><a class="el" href="classmongo_1_1dur_1_1DurableInterface.html">DurableInterface</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
