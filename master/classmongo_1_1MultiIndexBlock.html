<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Storage Engine API: mongo::MultiIndexBlock Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link href="mongodb.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="mongodb-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Storage Engine API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classmongo_1_1MultiIndexBlock.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classmongo_1_1MultiIndexBlock-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mongo::MultiIndexBlock Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Builds one or more indexes.  
 <a href="classmongo_1_1MultiIndexBlock.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="index__create_8h_source.html">index_create.h</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Builds one or more indexes. </p>
<p>If any method other than <a class="el" href="classmongo_1_1MultiIndexBlock.html#ac41a83e30f28f2d9cace2a36adbddde1" title="Call this after init() for each document in the collection. ">insert()</a> returns a not-ok Status, this <a class="el" href="classmongo_1_1MultiIndexBlock.html" title="Builds one or more indexes. ">MultiIndexBlock</a> should be considered failed and must be destroyed.</p>
<p>If a <a class="el" href="classmongo_1_1MultiIndexBlock.html" title="Builds one or more indexes. ">MultiIndexBlock</a> is destroyed before <a class="el" href="classmongo_1_1MultiIndexBlock.html#afd55357499ea41c9f3d29f903f1fd008" title="Marks the index ready for use. ">commit()</a> or if <a class="el" href="classmongo_1_1MultiIndexBlock.html#afd55357499ea41c9f3d29f903f1fd008" title="Marks the index ready for use. ">commit()</a> is rolled back, it will clean up all traces of the indexes being constructed. MultiIndexBlocks should not be destructed from inside of a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a> as any cleanup needed should never be rolled back (as it is itself essentially a form of rollback, you don't want to "rollback the rollback"). </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmongo_1_1MultiIndexBlock_1_1TUHook.html">TUHook</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7083768cf4b2a1cb3414f0276376514b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a7083768cf4b2a1cb3414f0276376514b">~MultiIndexBlock</a> ()=default</td></tr>
<tr class="separator:a7083768cf4b2a1cb3414f0276376514b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5d3fc01ebf73b53838d06c4238f530"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#aec5d3fc01ebf73b53838d06c4238f530">MultiIndexBlock</a> (OperationContext *const <a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>, <a class="el" href="classmongo_1_1Collection.html">Collection</a> *const <a class="el" href="namespacemongo.html#a2f403dd8ffd4ee0aee78ea0df01a3e37">collection</a>)</td></tr>
<tr class="memdesc:aec5d3fc01ebf73b53838d06c4238f530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neither pointer is owned.  <a href="#aec5d3fc01ebf73b53838d06c4238f530">More...</a><br /></td></tr>
<tr class="separator:aec5d3fc01ebf73b53838d06c4238f530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d30ce0735738f41b6a81b4e963a6a91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a8d30ce0735738f41b6a81b4e963a6a91">allowBackgroundBuilding</a> ()</td></tr>
<tr class="memdesc:a8d30ce0735738f41b6a81b4e963a6a91"><td class="mdescLeft">&#160;</td><td class="mdescRight">By default we ignore the 'background' flag in specs when building an index.  <a href="#a8d30ce0735738f41b6a81b4e963a6a91">More...</a><br /></td></tr>
<tr class="separator:a8d30ce0735738f41b6a81b4e963a6a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d5195e970d26732ccf65cf12f971bba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a2d5195e970d26732ccf65cf12f971bba">allowInterruption</a> ()</td></tr>
<tr class="memdesc:a2d5195e970d26732ccf65cf12f971bba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this before <a class="el" href="classmongo_1_1MultiIndexBlock.html#abd636af79c850c6ca89623402c00c9bc" title="Prepares the index(es) for building and returns the canonicalized form of the requested index specifi...">init()</a> to allow the index build to be interrupted.  <a href="#a2d5195e970d26732ccf65cf12f971bba">More...</a><br /></td></tr>
<tr class="separator:a2d5195e970d26732ccf65cf12f971bba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a710fcaa2007d8d39a8da96205f97d3ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a710fcaa2007d8d39a8da96205f97d3ee">ignoreUniqueConstraint</a> ()</td></tr>
<tr class="memdesc:a710fcaa2007d8d39a8da96205f97d3ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">By default we enforce the 'unique' flag in specs when building an index by failing.  <a href="#a710fcaa2007d8d39a8da96205f97d3ee">More...</a><br /></td></tr>
<tr class="separator:a710fcaa2007d8d39a8da96205f97d3ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14327ed4171bfd41745d69213dde8536"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a14327ed4171bfd41745d69213dde8536">removeExistingIndexes</a> (std::vector&lt; BSONObj &gt; *const specs) const</td></tr>
<tr class="memdesc:a14327ed4171bfd41745d69213dde8536"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes pre-existing indexes from 'specs'.  <a href="#a14327ed4171bfd41745d69213dde8536">More...</a><br /></td></tr>
<tr class="separator:a14327ed4171bfd41745d69213dde8536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd636af79c850c6ca89623402c00c9bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmongo_1_1StatusWith.html">StatusWith</a>&lt; std::vector&lt; BSONObj &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#abd636af79c850c6ca89623402c00c9bc">init</a> (const std::vector&lt; BSONObj &gt; &amp;specs)</td></tr>
<tr class="memdesc:abd636af79c850c6ca89623402c00c9bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the index(es) for building and returns the canonicalized form of the requested index specifications.  <a href="#abd636af79c850c6ca89623402c00c9bc">More...</a><br /></td></tr>
<tr class="separator:abd636af79c850c6ca89623402c00c9bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc7b6e119aada478420ea01f5463ef29"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmongo_1_1StatusWith.html">StatusWith</a>&lt; std::vector&lt; BSONObj &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#adc7b6e119aada478420ea01f5463ef29">init</a> (const BSONObj &amp;spec)</td></tr>
<tr class="separator:adc7b6e119aada478420ea01f5463ef29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4daf570c172eb919dae3b6e607d80951"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a4daf570c172eb919dae3b6e607d80951">insertAllDocumentsInCollection</a> (std::set&lt; RecordId &gt; *const dupsOut=nullptr)</td></tr>
<tr class="memdesc:a4daf570c172eb919dae3b6e607d80951"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts all documents in the <a class="el" href="classmongo_1_1Collection.html" title="this is NOT safe through a yield right now. ">Collection</a> into the indexes and logs with timing info.  <a href="#a4daf570c172eb919dae3b6e607d80951">More...</a><br /></td></tr>
<tr class="separator:a4daf570c172eb919dae3b6e607d80951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac41a83e30f28f2d9cace2a36adbddde1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#ac41a83e30f28f2d9cace2a36adbddde1">insert</a> (const BSONObj &amp;wholeDocument, const RecordId &amp;loc)</td></tr>
<tr class="memdesc:ac41a83e30f28f2d9cace2a36adbddde1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this after <a class="el" href="classmongo_1_1MultiIndexBlock.html#abd636af79c850c6ca89623402c00c9bc" title="Prepares the index(es) for building and returns the canonicalized form of the requested index specifi...">init()</a> for each document in the collection.  <a href="#ac41a83e30f28f2d9cace2a36adbddde1">More...</a><br /></td></tr>
<tr class="separator:ac41a83e30f28f2d9cace2a36adbddde1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad892b387df83a7f8c87ac79c6e12129f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#ad892b387df83a7f8c87ac79c6e12129f">doneInserting</a> (std::set&lt; RecordId &gt; *const dupsOut=nullptr)</td></tr>
<tr class="memdesc:ad892b387df83a7f8c87ac79c6e12129f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call this after the last <a class="el" href="classmongo_1_1MultiIndexBlock.html#ac41a83e30f28f2d9cace2a36adbddde1" title="Call this after init() for each document in the collection. ">insert()</a>.  <a href="#ad892b387df83a7f8c87ac79c6e12129f">More...</a><br /></td></tr>
<tr class="separator:ad892b387df83a7f8c87ac79c6e12129f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd55357499ea41c9f3d29f903f1fd008"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#afd55357499ea41c9f3d29f903f1fd008">commit</a> (stdx::function&lt; <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>(const BSONObj &amp;spec)&gt; onCreateFn=nullptr)</td></tr>
<tr class="memdesc:afd55357499ea41c9f3d29f903f1fd008"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks the index ready for use.  <a href="#afd55357499ea41c9f3d29f903f1fd008">More...</a><br /></td></tr>
<tr class="separator:afd55357499ea41c9f3d29f903f1fd008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaaedf6eabf40a9640ddd20ee2ca3458"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#aaaaedf6eabf40a9640ddd20ee2ca3458">abortWithoutCleanup</a> ()</td></tr>
<tr class="memdesc:aaaaedf6eabf40a9640ddd20ee2ca3458"><td class="mdescLeft">&#160;</td><td class="mdescRight">May be called at any time after construction but before a successful <a class="el" href="classmongo_1_1MultiIndexBlock.html#afd55357499ea41c9f3d29f903f1fd008" title="Marks the index ready for use. ">commit()</a>.  <a href="#aaaaedf6eabf40a9640ddd20ee2ca3458">More...</a><br /></td></tr>
<tr class="separator:aaaaedf6eabf40a9640ddd20ee2ca3458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebb8050a11ca55344200fecf282d1cab"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#aebb8050a11ca55344200fecf282d1cab">getBuildInBackground</a> () const</td></tr>
<tr class="separator:aebb8050a11ca55344200fecf282d1cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a7245f4f285c10d42d6ca3fa1ee394617"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a7245f4f285c10d42d6ca3fa1ee394617">MONGO_DECLARE_SHIM</a> ((OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>, <a class="el" href="classmongo_1_1Collection.html">Collection</a> *<a class="el" href="namespacemongo.html#a2f403dd8ffd4ee0aee78ea0df01a3e37">collection</a>, PrivateTo&lt; <a class="el" href="classmongo_1_1MultiIndexBlock.html">MultiIndexBlock</a> &gt;) -&gt;std::unique_ptr&lt; <a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a> &gt;) makeImpl</td></tr>
<tr class="separator:a7245f4f285c10d42d6ca3fa1ee394617"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a50f8241fadeeaa9837b445accba1f2b6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a50f8241fadeeaa9837b445accba1f2b6">_impl</a> () const</td></tr>
<tr class="separator:a50f8241fadeeaa9837b445accba1f2b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af872703295a6c42e4ca1294ece33fef6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#af872703295a6c42e4ca1294ece33fef6">_impl</a> ()</td></tr>
<tr class="separator:af872703295a6c42e4ca1294ece33fef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a103f536d0ebded78ab5f79dbaeab725a"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1MultiIndexBlock.html#a103f536d0ebded78ab5f79dbaeab725a">_pimpl</a></td></tr>
<tr class="separator:a103f536d0ebded78ab5f79dbaeab725a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7083768cf4b2a1cb3414f0276376514b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7083768cf4b2a1cb3414f0276376514b">&#9670;&nbsp;</a></span>~MultiIndexBlock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mongo::MultiIndexBlock::~MultiIndexBlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aec5d3fc01ebf73b53838d06c4238f530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5d3fc01ebf73b53838d06c4238f530">&#9670;&nbsp;</a></span>MultiIndexBlock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mongo::MultiIndexBlock::MultiIndexBlock </td>
          <td>(</td>
          <td class="paramtype">OperationContext *const&#160;</td>
          <td class="paramname"><em>opCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmongo_1_1Collection.html">Collection</a> *const&#160;</td>
          <td class="paramname"><em>collection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Neither pointer is owned. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a50f8241fadeeaa9837b445accba1f2b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50f8241fadeeaa9837b445accba1f2b6">&#9670;&nbsp;</a></span>_impl() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a>&amp; mongo::MultiIndexBlock::_impl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af872703295a6c42e4ca1294ece33fef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af872703295a6c42e4ca1294ece33fef6">&#9670;&nbsp;</a></span>_impl() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a>&amp; mongo::MultiIndexBlock::_impl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aaaaedf6eabf40a9640ddd20ee2ca3458"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaaedf6eabf40a9640ddd20ee2ca3458">&#9670;&nbsp;</a></span>abortWithoutCleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::MultiIndexBlock::abortWithoutCleanup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>May be called at any time after construction but before a successful <a class="el" href="classmongo_1_1MultiIndexBlock.html#afd55357499ea41c9f3d29f903f1fd008" title="Marks the index ready for use. ">commit()</a>. </p>
<p>Suppresses the default behavior on destruction of removing all traces of uncommitted index builds.</p>
<p>The most common use of this is if the indexes were already dropped via some other mechanism such as the whole collection being dropped. In that case, it would be invalid to try to remove the indexes again. Also, replication uses this to ensure that indexes that are being built on shutdown are resumed on startup.</p>
<p>Do not use this unless you are really sure you need to.</p>
<p>Does not matter whether it is called inside of a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a>. Will not be rolled back. </p>

</div>
</div>
<a id="a8d30ce0735738f41b6a81b4e963a6a91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d30ce0735738f41b6a81b4e963a6a91">&#9670;&nbsp;</a></span>allowBackgroundBuilding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::MultiIndexBlock::allowBackgroundBuilding </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>By default we ignore the 'background' flag in specs when building an index. </p>
<p>If this is called before <a class="el" href="classmongo_1_1MultiIndexBlock.html#abd636af79c850c6ca89623402c00c9bc" title="Prepares the index(es) for building and returns the canonicalized form of the requested index specifi...">init()</a>, we will build the indexes in the background as long as <em>all</em> specs call for background indexing. If any spec calls for foreground indexing all indexes will be built in the foreground, as there is no concurrency benefit to building a subset of indexes in the background, but there is a performance benefit to building all in the foreground. </p>

</div>
</div>
<a id="a2d5195e970d26732ccf65cf12f971bba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d5195e970d26732ccf65cf12f971bba">&#9670;&nbsp;</a></span>allowInterruption()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::MultiIndexBlock::allowInterruption </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Call this before <a class="el" href="classmongo_1_1MultiIndexBlock.html#abd636af79c850c6ca89623402c00c9bc" title="Prepares the index(es) for building and returns the canonicalized form of the requested index specifi...">init()</a> to allow the index build to be interrupted. </p>
<p>This only affects builds using the insertAllDocumentsInCollection helper. </p>

</div>
</div>
<a id="afd55357499ea41c9f3d29f903f1fd008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd55357499ea41c9f3d29f903f1fd008">&#9670;&nbsp;</a></span>commit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::MultiIndexBlock::commit </td>
          <td>(</td>
          <td class="paramtype">stdx::function&lt; <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>(const BSONObj &amp;spec)&gt;&#160;</td>
          <td class="paramname"><em>onCreateFn</em> = <code>nullptr</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks the index ready for use. </p>
<p>Should only be called as the last method after <a class="el" href="classmongo_1_1MultiIndexBlock.html#ad892b387df83a7f8c87ac79c6e12129f" title="Call this after the last insert(). ">doneInserting()</a> or <a class="el" href="classmongo_1_1MultiIndexBlock.html#a4daf570c172eb919dae3b6e607d80951" title="Inserts all documents in the Collection into the indexes and logs with timing info. ">insertAllDocumentsInCollection()</a> return success.</p>
<p>Should be called inside of a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a>. If the index building is to be logOp'd, logOp() should be called from the same unit of work as <a class="el" href="classmongo_1_1MultiIndexBlock.html#afd55357499ea41c9f3d29f903f1fd008" title="Marks the index ready for use. ">commit()</a>.</p>
<p><code>onCreateFn</code> will be called on each index before writes that mark the index as "ready".</p>
<p>Requires holding an exclusive database lock. </p>

</div>
</div>
<a id="ad892b387df83a7f8c87ac79c6e12129f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad892b387df83a7f8c87ac79c6e12129f">&#9670;&nbsp;</a></span>doneInserting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> mongo::MultiIndexBlock::doneInserting </td>
          <td>(</td>
          <td class="paramtype">std::set&lt; RecordId &gt; *const&#160;</td>
          <td class="paramname"><em>dupsOut</em> = <code>nullptr</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Call this after the last <a class="el" href="classmongo_1_1MultiIndexBlock.html#ac41a83e30f28f2d9cace2a36adbddde1" title="Call this after init() for each document in the collection. ">insert()</a>. </p>
<p>This gives the index builder a chance to do any long-running operations in separate units of work from <a class="el" href="classmongo_1_1MultiIndexBlock.html#afd55357499ea41c9f3d29f903f1fd008" title="Marks the index ready for use. ">commit()</a>.</p>
<p>Do not call if you called <a class="el" href="classmongo_1_1MultiIndexBlock.html#a4daf570c172eb919dae3b6e607d80951" title="Inserts all documents in the Collection into the indexes and logs with timing info. ">insertAllDocumentsInCollection()</a>;</p>
<p>If dupsOut is passed as non-NULL, violators of uniqueness constraints will be added to the set. Documents added to this set are not indexed, so callers MUST either fail this index build or delete the documents from the collection.</p>
<p>Should not be called inside of a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a>. </p>

</div>
</div>
<a id="aebb8050a11ca55344200fecf282d1cab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebb8050a11ca55344200fecf282d1cab">&#9670;&nbsp;</a></span>getBuildInBackground()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool mongo::MultiIndexBlock::getBuildInBackground </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a710fcaa2007d8d39a8da96205f97d3ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a710fcaa2007d8d39a8da96205f97d3ee">&#9670;&nbsp;</a></span>ignoreUniqueConstraint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::MultiIndexBlock::ignoreUniqueConstraint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>By default we enforce the 'unique' flag in specs when building an index by failing. </p>
<p>If this is called before <a class="el" href="classmongo_1_1MultiIndexBlock.html#abd636af79c850c6ca89623402c00c9bc" title="Prepares the index(es) for building and returns the canonicalized form of the requested index specifi...">init()</a>, we will ignore unique violations. This has no effect if no specs are unique.</p>
<p>If this is called, any dupsOut sets passed in will never be filled. </p>

</div>
</div>
<a id="abd636af79c850c6ca89623402c00c9bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd636af79c850c6ca89623402c00c9bc">&#9670;&nbsp;</a></span>init() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmongo_1_1StatusWith.html">StatusWith</a>&lt;std::vector&lt;BSONObj&gt; &gt; mongo::MultiIndexBlock::init </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; BSONObj &gt; &amp;&#160;</td>
          <td class="paramname"><em>specs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepares the index(es) for building and returns the canonicalized form of the requested index specifications. </p>
<p>Does not need to be called inside of a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a> (but can be due to nesting).</p>
<p>Requires holding an exclusive database lock. </p>

</div>
</div>
<a id="adc7b6e119aada478420ea01f5463ef29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc7b6e119aada478420ea01f5463ef29">&#9670;&nbsp;</a></span>init() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmongo_1_1StatusWith.html">StatusWith</a>&lt;std::vector&lt;BSONObj&gt; &gt; mongo::MultiIndexBlock::init </td>
          <td>(</td>
          <td class="paramtype">const BSONObj &amp;&#160;</td>
          <td class="paramname"><em>spec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac41a83e30f28f2d9cace2a36adbddde1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac41a83e30f28f2d9cace2a36adbddde1">&#9670;&nbsp;</a></span>insert()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> mongo::MultiIndexBlock::insert </td>
          <td>(</td>
          <td class="paramtype">const BSONObj &amp;&#160;</td>
          <td class="paramname"><em>wholeDocument</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RecordId &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Call this after <a class="el" href="classmongo_1_1MultiIndexBlock.html#abd636af79c850c6ca89623402c00c9bc" title="Prepares the index(es) for building and returns the canonicalized form of the requested index specifi...">init()</a> for each document in the collection. </p>
<p>Do not call if you called <a class="el" href="classmongo_1_1MultiIndexBlock.html#a4daf570c172eb919dae3b6e607d80951" title="Inserts all documents in the Collection into the indexes and logs with timing info. ">insertAllDocumentsInCollection()</a>;</p>
<p>Should be called inside of a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a>. </p>

</div>
</div>
<a id="a4daf570c172eb919dae3b6e607d80951"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4daf570c172eb919dae3b6e607d80951">&#9670;&nbsp;</a></span>insertAllDocumentsInCollection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> mongo::MultiIndexBlock::insertAllDocumentsInCollection </td>
          <td>(</td>
          <td class="paramtype">std::set&lt; RecordId &gt; *const&#160;</td>
          <td class="paramname"><em>dupsOut</em> = <code>nullptr</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inserts all documents in the <a class="el" href="classmongo_1_1Collection.html" title="this is NOT safe through a yield right now. ">Collection</a> into the indexes and logs with timing info. </p>
<p>This is a simplified replacement for insert and doneInserting. Do not call this if you are calling either of them.</p>
<p>If dupsOut is passed as non-NULL, violators of uniqueness constraints will be added to the set rather than failing the build. Documents added to this set are not indexed, so callers MUST either fail this index build or delete the documents from the collection.</p>
<p>Can throw an exception if interrupted.</p>
<p>Should not be called inside of a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a>. </p>

</div>
</div>
<a id="a7245f4f285c10d42d6ca3fa1ee394617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7245f4f285c10d42d6ca3fa1ee394617">&#9670;&nbsp;</a></span>MONGO_DECLARE_SHIM()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mongo::MultiIndexBlock::MONGO_DECLARE_SHIM </td>
          <td>(</td>
          <td class="paramtype">(OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>, <a class="el" href="classmongo_1_1Collection.html">Collection</a> *<a class="el" href="namespacemongo.html#a2f403dd8ffd4ee0aee78ea0df01a3e37">collection</a>, PrivateTo&lt; <a class="el" href="classmongo_1_1MultiIndexBlock.html">MultiIndexBlock</a> &gt;) -&gt;std::unique_ptr&lt; <a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a> &gt;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a14327ed4171bfd41745d69213dde8536"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14327ed4171bfd41745d69213dde8536">&#9670;&nbsp;</a></span>removeExistingIndexes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::MultiIndexBlock::removeExistingIndexes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; BSONObj &gt; *const&#160;</td>
          <td class="paramname"><em>specs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes pre-existing indexes from 'specs'. </p>
<p>If this isn't done, <a class="el" href="classmongo_1_1MultiIndexBlock.html#abd636af79c850c6ca89623402c00c9bc" title="Prepares the index(es) for building and returns the canonicalized form of the requested index specifi...">init()</a> may fail with IndexAlreadyExists. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a103f536d0ebded78ab5f79dbaeab725a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a103f536d0ebded78ab5f79dbaeab725a">&#9670;&nbsp;</a></span>_pimpl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classmongo_1_1MultiIndexBlock_1_1Impl.html">Impl</a>&gt; mongo::MultiIndexBlock::_pimpl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/louis/git/mongo/src/mongo/db/catalog/<a class="el" href="index__create_8h_source.html">index_create.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemongo.html">mongo</a></li><li class="navelem"><a class="el" href="classmongo_1_1MultiIndexBlock.html">MultiIndexBlock</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
