<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Storage Engine API: mongo::StorageEngine Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link href="mongodb.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="mongodb-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Storage Engine API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classmongo_1_1StorageEngine.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classmongo_1_1StorageEngine-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mongo::StorageEngine Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classmongo_1_1StorageEngine.html" title="The StorageEngine class is the top level interface for creating a new storage engine. ">StorageEngine</a> class is the top level interface for creating a new storage engine.  
 <a href="classmongo_1_1StorageEngine.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="storage__engine_8h_source.html">storage_engine.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for mongo::StorageEngine:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmongo_1_1StorageEngine.png" usemap="#mongo::StorageEngine_map" alt=""/>
  <map id="mongo::StorageEngine_map" name="mongo::StorageEngine_map">
<area href="classmongo_1_1KVStorageEngine.html" alt="mongo::KVStorageEngine" shape="rect" coords="0,56,155,80"/>
<area href="classmongo_1_1MMAPV1Engine.html" alt="mongo::MMAPV1Engine" shape="rect" coords="165,56,320,80"/>
</map>
 </div></div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classmongo_1_1StorageEngine.html" title="The StorageEngine class is the top level interface for creating a new storage engine. ">StorageEngine</a> class is the top level interface for creating a new storage engine. </p>
<p>All StorageEngine(s) must be registered by calling registerFactory in order to possibly be activated. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine_1_1Factory.html">Factory</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The interface for creating new instances of storage engines.  <a href="classmongo_1_1StorageEngine_1_1Factory.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ae64a0ea2f55ed12186a2aee8a34c793b"><td class="memItemLeft" align="right" valign="top">typedef std::pair&lt; std::string, std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#ae64a0ea2f55ed12186a2aee8a34c793b">CollectionIndexNamePair</a></td></tr>
<tr class="separator:ae64a0ea2f55ed12186a2aee8a34c793b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3dfbb55646e9a8e8c41282cf1608c0f6"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a3dfbb55646e9a8e8c41282cf1608c0f6">~StorageEngine</a> ()</td></tr>
<tr class="memdesc:a3dfbb55646e9a8e8c41282cf1608c0f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The destructor should only be called if we are tearing down but not exiting the process.  <a href="#a3dfbb55646e9a8e8c41282cf1608c0f6">More...</a><br /></td></tr>
<tr class="separator:a3dfbb55646e9a8e8c41282cf1608c0f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779d1e55b46d3052a954d7503adf309e"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a779d1e55b46d3052a954d7503adf309e">finishInit</a> ()</td></tr>
<tr class="memdesc:a779d1e55b46d3052a954d7503adf309e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called after the globalStorageEngine pointer has been set up, before any other methods are called.  <a href="#a779d1e55b46d3052a954d7503adf309e">More...</a><br /></td></tr>
<tr class="separator:a779d1e55b46d3052a954d7503adf309e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ab3dbc3ba656ac00481210a2ce8c45"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmongo_1_1RecoveryUnit.html">RecoveryUnit</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#ac9ab3dbc3ba656ac00481210a2ce8c45">newRecoveryUnit</a> ()=0</td></tr>
<tr class="memdesc:ac9ab3dbc3ba656ac00481210a2ce8c45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a new interface to the storage engine's recovery unit.  <a href="#ac9ab3dbc3ba656ac00481210a2ce8c45">More...</a><br /></td></tr>
<tr class="separator:ac9ab3dbc3ba656ac00481210a2ce8c45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a90adedcbda8f43a80878e86b55da85"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a9a90adedcbda8f43a80878e86b55da85">listDatabases</a> (std::vector&lt; std::string &gt; *out) const =0</td></tr>
<tr class="memdesc:a9a90adedcbda8f43a80878e86b55da85"><td class="mdescLeft">&#160;</td><td class="mdescRight">List the databases stored in this storage engine.  <a href="#a9a90adedcbda8f43a80878e86b55da85">More...</a><br /></td></tr>
<tr class="separator:a9a90adedcbda8f43a80878e86b55da85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e78f6f7c6fa5615b8a5f81f933cb3b4"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmongo_1_1DatabaseCatalogEntry.html">DatabaseCatalogEntry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a2e78f6f7c6fa5615b8a5f81f933cb3b4">getDatabaseCatalogEntry</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>, StringData <a class="el" href="namespacemongo.html#a4ae6ca2f1e345dcee0a3bf19089f12f0">db</a>)=0</td></tr>
<tr class="memdesc:a2e78f6f7c6fa5615b8a5f81f933cb3b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the <a class="el" href="classmongo_1_1DatabaseCatalogEntry.html">DatabaseCatalogEntry</a> that describes the database indicated by 'db'.  <a href="#a2e78f6f7c6fa5615b8a5f81f933cb3b4">More...</a><br /></td></tr>
<tr class="separator:a2e78f6f7c6fa5615b8a5f81f933cb3b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf0dfc56e0509914e839c8587fd0ee7d"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#aaf0dfc56e0509914e839c8587fd0ee7d">supportsDocLocking</a> () const =0</td></tr>
<tr class="memdesc:aaf0dfc56e0509914e839c8587fd0ee7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the storage engine supports its own locking locking below the collection level.  <a href="#aaf0dfc56e0509914e839c8587fd0ee7d">More...</a><br /></td></tr>
<tr class="separator:aaf0dfc56e0509914e839c8587fd0ee7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97a5327723286b781a9d735a1bf80b46"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a97a5327723286b781a9d735a1bf80b46">supportsDBLocking</a> () const</td></tr>
<tr class="memdesc:a97a5327723286b781a9d735a1bf80b46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the storage engine supports locking at a database level.  <a href="#a97a5327723286b781a9d735a1bf80b46">More...</a><br /></td></tr>
<tr class="separator:a97a5327723286b781a9d735a1bf80b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64bee4921853cd93667987cc98858886"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a64bee4921853cd93667987cc98858886">supportsCappedCollections</a> () const</td></tr>
<tr class="memdesc:a64bee4921853cd93667987cc98858886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the storage engine supports capped collections.  <a href="#a64bee4921853cd93667987cc98858886">More...</a><br /></td></tr>
<tr class="separator:a64bee4921853cd93667987cc98858886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad11089c3879e353ffaaf82e0f5c1d1f4"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#ad11089c3879e353ffaaf82e0f5c1d1f4">isDurable</a> () const =0</td></tr>
<tr class="memdesc:ad11089c3879e353ffaaf82e0f5c1d1f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the engine supports a journalling concept or not.  <a href="#ad11089c3879e353ffaaf82e0f5c1d1f4">More...</a><br /></td></tr>
<tr class="separator:ad11089c3879e353ffaaf82e0f5c1d1f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d78f2fc178a5b1d07f3dbd995b8481e"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a0d78f2fc178a5b1d07f3dbd995b8481e">isEphemeral</a> () const =0</td></tr>
<tr class="memdesc:a0d78f2fc178a5b1d07f3dbd995b8481e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the engine does not persist data to disk; false otherwise.  <a href="#a0d78f2fc178a5b1d07f3dbd995b8481e">More...</a><br /></td></tr>
<tr class="separator:a0d78f2fc178a5b1d07f3dbd995b8481e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33bb304280d13f9526986c44fed3a7ca"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a33bb304280d13f9526986c44fed3a7ca">isMmapV1</a> () const</td></tr>
<tr class="memdesc:a33bb304280d13f9526986c44fed3a7ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Only MMAPv1 should override this and return true to trigger MMAPv1-specific behavior.  <a href="#a33bb304280d13f9526986c44fed3a7ca">More...</a><br /></td></tr>
<tr class="separator:a33bb304280d13f9526986c44fed3a7ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85e34ad431938728c6298468ecc7da53"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a85e34ad431938728c6298468ecc7da53">loadCatalog</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)</td></tr>
<tr class="memdesc:a85e34ad431938728c6298468ecc7da53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates and tears down in-memory data structures, respectively.  <a href="#a85e34ad431938728c6298468ecc7da53">More...</a><br /></td></tr>
<tr class="separator:a85e34ad431938728c6298468ecc7da53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fdbd8c81df1ae30cf33d754c90d6f47"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a3fdbd8c81df1ae30cf33d754c90d6f47">closeCatalog</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)</td></tr>
<tr class="separator:a3fdbd8c81df1ae30cf33d754c90d6f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d09d544bed98f57a14daff8cadc1a3"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#ab9d09d544bed98f57a14daff8cadc1a3">closeDatabase</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>, StringData <a class="el" href="namespacemongo.html#a4ae6ca2f1e345dcee0a3bf19089f12f0">db</a>)=0</td></tr>
<tr class="memdesc:ab9d09d544bed98f57a14daff8cadc1a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes all file handles associated with a database.  <a href="#ab9d09d544bed98f57a14daff8cadc1a3">More...</a><br /></td></tr>
<tr class="separator:ab9d09d544bed98f57a14daff8cadc1a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadd689646a3b23fe88fb873f19b0c946"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#aadd689646a3b23fe88fb873f19b0c946">dropDatabase</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>, StringData <a class="el" href="namespacemongo.html#a4ae6ca2f1e345dcee0a3bf19089f12f0">db</a>)=0</td></tr>
<tr class="memdesc:aadd689646a3b23fe88fb873f19b0c946"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes all data and metadata for a database.  <a href="#aadd689646a3b23fe88fb873f19b0c946">More...</a><br /></td></tr>
<tr class="separator:aadd689646a3b23fe88fb873f19b0c946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc70f10ab115ffb7a18a3d0189ac9176"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#afc70f10ab115ffb7a18a3d0189ac9176">flushAllFiles</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>, bool sync)=0</td></tr>
<tr class="separator:afc70f10ab115ffb7a18a3d0189ac9176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad40644ee1add010e9e8e746ffb8c91d2"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#ad40644ee1add010e9e8e746ffb8c91d2">beginBackup</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)</td></tr>
<tr class="memdesc:ad40644ee1add010e9e8e746ffb8c91d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transitions the storage engine into backup mode.  <a href="#ad40644ee1add010e9e8e746ffb8c91d2">More...</a><br /></td></tr>
<tr class="separator:ad40644ee1add010e9e8e746ffb8c91d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ebe160dc5086e8c87eb54e9dd9c1aa5"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a9ebe160dc5086e8c87eb54e9dd9c1aa5">endBackup</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)</td></tr>
<tr class="memdesc:a9ebe160dc5086e8c87eb54e9dd9c1aa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transitions the storage engine out of backup mode.  <a href="#a9ebe160dc5086e8c87eb54e9dd9c1aa5">More...</a><br /></td></tr>
<tr class="separator:a9ebe160dc5086e8c87eb54e9dd9c1aa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeb3b3983813f900f61a4389602d5007"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#afeb3b3983813f900f61a4389602d5007">repairRecordStore</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>, const std::string &amp;<a class="el" href="namespacemongo.html#aa1aad236ca83643ab0718062dd62f4fc">ns</a>)=0</td></tr>
<tr class="memdesc:afeb3b3983813f900f61a4389602d5007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recover as much data as possible from a potentially corrupt <a class="el" href="classmongo_1_1RecordStore.html" title="An abstraction used for storing documents in a collection or entries in an index. ...">RecordStore</a>.  <a href="#afeb3b3983813f900f61a4389602d5007">More...</a><br /></td></tr>
<tr class="separator:afeb3b3983813f900f61a4389602d5007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a8d564d6ddbc279938d60ec8d16dd54"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a8a8d564d6ddbc279938d60ec8d16dd54">cleanShutdown</a> ()=0</td></tr>
<tr class="memdesc:a8a8d564d6ddbc279938d60ec8d16dd54"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method will be called before there is a clean shutdown.  <a href="#a8a8d564d6ddbc279938d60ec8d16dd54">More...</a><br /></td></tr>
<tr class="separator:a8a8d564d6ddbc279938d60ec8d16dd54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a620e7d61feab83f9d80c9edcc68d2cc2"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmongo_1_1SnapshotManager.html">SnapshotManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a620e7d61feab83f9d80c9edcc68d2cc2">getSnapshotManager</a> () const</td></tr>
<tr class="memdesc:a620e7d61feab83f9d80c9edcc68d2cc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the <a class="el" href="classmongo_1_1SnapshotManager.html" title="Manages snapshots that can be read from at a later time. ">SnapshotManager</a> for this <a class="el" href="classmongo_1_1StorageEngine.html" title="The StorageEngine class is the top level interface for creating a new storage engine. ">StorageEngine</a> or NULL if not supported.  <a href="#a620e7d61feab83f9d80c9edcc68d2cc2">More...</a><br /></td></tr>
<tr class="separator:a620e7d61feab83f9d80c9edcc68d2cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade3508d474e1fd9a168085a8a4d73828"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#ade3508d474e1fd9a168085a8a4d73828">setJournalListener</a> (<a class="el" href="classmongo_1_1JournalListener.html">JournalListener</a> *jl)=0</td></tr>
<tr class="memdesc:ade3508d474e1fd9a168085a8a4d73828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a new <a class="el" href="classmongo_1_1JournalListener.html" title="This class allows for the storageEngine to alert the rest of the system about journaled write progres...">JournalListener</a>, which is used by the storage engine to alert the rest of the system about journaled write progress.  <a href="#ade3508d474e1fd9a168085a8a4d73828">More...</a><br /></td></tr>
<tr class="separator:ade3508d474e1fd9a168085a8a4d73828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab3130a17adcd7174e9ad92af9024668"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#aab3130a17adcd7174e9ad92af9024668">supportsRecoverToStableTimestamp</a> () const</td></tr>
<tr class="memdesc:aab3130a17adcd7174e9ad92af9024668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the storage engine supports "recover to stable timestamp".  <a href="#aab3130a17adcd7174e9ad92af9024668">More...</a><br /></td></tr>
<tr class="separator:aab3130a17adcd7174e9ad92af9024668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf06242a2aed0d1c4a54fd3e1460852"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#aacf06242a2aed0d1c4a54fd3e1460852">supportsReadConcernSnapshot</a> () const</td></tr>
<tr class="memdesc:aacf06242a2aed0d1c4a54fd3e1460852"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the storage engine supports the readConcern level "snapshot".  <a href="#aacf06242a2aed0d1c4a54fd3e1460852">More...</a><br /></td></tr>
<tr class="separator:aacf06242a2aed0d1c4a54fd3e1460852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fcc405b3d23c6164bde892026f66e94"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmongo_1_1StatusWith.html">StatusWith</a>&lt; Timestamp &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a5fcc405b3d23c6164bde892026f66e94">recoverToStableTimestamp</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)</td></tr>
<tr class="memdesc:a5fcc405b3d23c6164bde892026f66e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recovers the storage engine state to the last stable timestamp.  <a href="#a5fcc405b3d23c6164bde892026f66e94">More...</a><br /></td></tr>
<tr class="separator:a5fcc405b3d23c6164bde892026f66e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79930a6f501a2ad71b942f76bc5bb74f"><td class="memItemLeft" align="right" valign="top">virtual boost::optional&lt; Timestamp &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a79930a6f501a2ad71b942f76bc5bb74f">getRecoveryTimestamp</a> () const</td></tr>
<tr class="memdesc:a79930a6f501a2ad71b942f76bc5bb74f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the stable timestamp that the storage engine recovered to on startup.  <a href="#a79930a6f501a2ad71b942f76bc5bb74f">More...</a><br /></td></tr>
<tr class="separator:a79930a6f501a2ad71b942f76bc5bb74f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83f7e872d15697c9c3bf50ed12964735"><td class="memItemLeft" align="right" valign="top">virtual boost::optional&lt; Timestamp &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a83f7e872d15697c9c3bf50ed12964735">getLastStableCheckpointTimestamp</a> () const</td></tr>
<tr class="memdesc:a83f7e872d15697c9c3bf50ed12964735"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a timestamp that is guaranteed to be persisted to disk in a checkpoint.  <a href="#a83f7e872d15697c9c3bf50ed12964735">More...</a><br /></td></tr>
<tr class="separator:a83f7e872d15697c9c3bf50ed12964735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1c5cec571e7cb649c4c7b2e56df2469"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#ae1c5cec571e7cb649c4c7b2e56df2469">setStableTimestamp</a> (Timestamp timestamp)</td></tr>
<tr class="memdesc:ae1c5cec571e7cb649c4c7b2e56df2469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the highest timestamp at which the storage engine is allowed to take a checkpoint.  <a href="#ae1c5cec571e7cb649c4c7b2e56df2469">More...</a><br /></td></tr>
<tr class="separator:ae1c5cec571e7cb649c4c7b2e56df2469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae382900644bc641160eb784aec54b873"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#ae382900644bc641160eb784aec54b873">setInitialDataTimestamp</a> (Timestamp timestamp)</td></tr>
<tr class="memdesc:ae382900644bc641160eb784aec54b873"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tells the storage engine the timestamp of the data at startup.  <a href="#ae382900644bc641160eb784aec54b873">More...</a><br /></td></tr>
<tr class="separator:ae382900644bc641160eb784aec54b873"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a545160909125b61e22400d775b43ec8c"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a545160909125b61e22400d775b43ec8c">setOldestTimestampFromStable</a> ()</td></tr>
<tr class="memdesc:a545160909125b61e22400d775b43ec8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the current stable timestamp to set the oldest timestamp for which the storage engine must maintain snapshot history through.  <a href="#a545160909125b61e22400d775b43ec8c">More...</a><br /></td></tr>
<tr class="separator:a545160909125b61e22400d775b43ec8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d28bc4cdfbfea2083f822c13207ff1"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a69d28bc4cdfbfea2083f822c13207ff1">setOldestTimestamp</a> (Timestamp timestamp)</td></tr>
<tr class="memdesc:a69d28bc4cdfbfea2083f822c13207ff1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the oldest timestamp for which the storage engine must maintain snapshot history through.  <a href="#a69d28bc4cdfbfea2083f822c13207ff1">More...</a><br /></td></tr>
<tr class="separator:a69d28bc4cdfbfea2083f822c13207ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8292fa3ea82b903c56713db94daff6a"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#af8292fa3ea82b903c56713db94daff6a">isCacheUnderPressure</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>) const</td></tr>
<tr class="memdesc:af8292fa3ea82b903c56713db94daff6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates whether the storage engine cache is under pressure.  <a href="#af8292fa3ea82b903c56713db94daff6a">More...</a><br /></td></tr>
<tr class="separator:af8292fa3ea82b903c56713db94daff6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c01bfd4089ee9fb2bd05753b900c56"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a11c01bfd4089ee9fb2bd05753b900c56">setCachePressureForTest</a> (int pressure)</td></tr>
<tr class="memdesc:a11c01bfd4089ee9fb2bd05753b900c56"><td class="mdescLeft">&#160;</td><td class="mdescRight">For unit tests only.  <a href="#a11c01bfd4089ee9fb2bd05753b900c56">More...</a><br /></td></tr>
<tr class="separator:a11c01bfd4089ee9fb2bd05753b900c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c27216fc7815098dddaf7342749a4f8"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a9c27216fc7815098dddaf7342749a4f8">replicationBatchIsComplete</a> () const</td></tr>
<tr class="memdesc:a9c27216fc7815098dddaf7342749a4f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notifies the storage engine that a replication batch has completed.  <a href="#a9c27216fc7815098dddaf7342749a4f8">More...</a><br /></td></tr>
<tr class="separator:a9c27216fc7815098dddaf7342749a4f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e7099c6ec62f2de75cd9d018c08e30a"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmongo_1_1StatusWith.html">StatusWith</a>&lt; std::vector&lt; <a class="el" href="classmongo_1_1StorageEngine.html#ae64a0ea2f55ed12186a2aee8a34c793b">CollectionIndexNamePair</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a4e7099c6ec62f2de75cd9d018c08e30a">reconcileCatalogAndIdents</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>)</td></tr>
<tr class="memdesc:a4e7099c6ec62f2de75cd9d018c08e30a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drop abandoned idents.  <a href="#a4e7099c6ec62f2de75cd9d018c08e30a">More...</a><br /></td></tr>
<tr class="separator:a4e7099c6ec62f2de75cd9d018c08e30a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a426e68e950295b64ab3341471e1927"><td class="memItemLeft" align="right" valign="top">virtual Timestamp&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1StorageEngine.html#a2a426e68e950295b64ab3341471e1927">getAllCommittedTimestamp</a> () const =0</td></tr>
<tr class="memdesc:a2a426e68e950295b64ab3341471e1927"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the all committed timestamp.  <a href="#a2a426e68e950295b64ab3341471e1927">More...</a><br /></td></tr>
<tr class="separator:a2a426e68e950295b64ab3341471e1927"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ae64a0ea2f55ed12186a2aee8a34c793b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae64a0ea2f55ed12186a2aee8a34c793b">&#9670;&nbsp;</a></span>CollectionIndexNamePair</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::pair&lt;std::string, std::string&gt; <a class="el" href="classmongo_1_1StorageEngine.html#ae64a0ea2f55ed12186a2aee8a34c793b">mongo::StorageEngine::CollectionIndexNamePair</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3dfbb55646e9a8e8c41282cf1608c0f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dfbb55646e9a8e8c41282cf1608c0f6">&#9670;&nbsp;</a></span>~StorageEngine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual mongo::StorageEngine::~StorageEngine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The destructor should only be called if we are tearing down but not exiting the process. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad40644ee1add010e9e8e746ffb8c91d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad40644ee1add010e9e8e746ffb8c91d2">&#9670;&nbsp;</a></span>beginBackup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> mongo::StorageEngine::beginBackup </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transitions the storage engine into backup mode. </p>
<p>During backup mode the storage engine must stabilize its on-disk files, and avoid any internal processing that may involve file I/O, such as online compaction, so a filesystem level backup may be performed.</p>
<p>Storage engines that do not support this feature should use the default implementation. Storage engines that implement this must also implement <a class="el" href="classmongo_1_1StorageEngine.html#a9ebe160dc5086e8c87eb54e9dd9c1aa5" title="Transitions the storage engine out of backup mode. ">endBackup()</a>.</p>
<p>For Storage engines that implement beginBackup the _inBackupMode variable is provided to avoid multiple instance enterting/leaving backup concurrently.</p>
<p>If this function returns an OK status, MongoDB can call endBackup to signal the storage engine that filesystem writes may continue. This function should return a non-OK status if filesystem changes cannot be stopped to allow for online backup. If the function should be retried, returns a non-OK status. This function may throw a <a class="el" href="classmongo_1_1WriteConflictException.html" title="This is thrown if during a write, two or more operations conflict with each other. ">WriteConflictException</a>, which should trigger a retry by the caller. All other exceptions should be treated as errors. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#ac8e92cb418218aa9ea6840f72b500402">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a13537c5dc05eda6e1cc8fe16ba7bc247">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a8a8d564d6ddbc279938d60ec8d16dd54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a8d564d6ddbc279938d60ec8d16dd54">&#9670;&nbsp;</a></span>cleanShutdown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::cleanShutdown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method will be called before there is a clean shutdown. </p>
<p>Storage engines should override this method if they have clean-up to do that is different from unclean shutdown. MongoDB will not call into the storage subsystem after calling this function.</p>
<p>On error, the storage engine should assert and crash. There is intentionally no uncleanShutdown(). </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a1cd4bff9edda16ed1fa07ac965439b36">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a025fcd63d5a0d9f01affc81f088d19b0">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a3fdbd8c81df1ae30cf33d754c90d6f47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fdbd8c81df1ae30cf33d754c90d6f47">&#9670;&nbsp;</a></span>closeCatalog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::closeCatalog </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#af59b15a8468c19f6b297e6f61ceea108">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="ab9d09d544bed98f57a14daff8cadc1a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9d09d544bed98f57a14daff8cadc1a3">&#9670;&nbsp;</a></span>closeDatabase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> mongo::StorageEngine::closeDatabase </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StringData&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Closes all file handles associated with a database. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a49afe684a8c3b3584c607cb8fc5ce18b">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a551b69ea194eb2f260dd65008def685c">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="aadd689646a3b23fe88fb873f19b0c946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadd689646a3b23fe88fb873f19b0c946">&#9670;&nbsp;</a></span>dropDatabase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> mongo::StorageEngine::dropDatabase </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StringData&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deletes all data and metadata for a database. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a224750035fbe1c90609a1460dc178362">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#afe02a242a7a404e38d31cd7753ae80d7">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a9ebe160dc5086e8c87eb54e9dd9c1aa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ebe160dc5086e8c87eb54e9dd9c1aa5">&#9670;&nbsp;</a></span>endBackup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::endBackup </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transitions the storage engine out of backup mode. </p>
<p>Storage engines that do not support this feature should use the default implementation.</p>
<p>Storage engines implementing this feature should fassert when unable to leave backup mode. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#abc07929ce0bac83a5d5ed0dd4e8a2c91">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a8354e58b6289b5d97a6dac9e832116aa">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a779d1e55b46d3052a954d7503adf309e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779d1e55b46d3052a954d7503adf309e">&#9670;&nbsp;</a></span>finishInit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::finishInit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called after the globalStorageEngine pointer has been set up, before any other methods are called. </p>
<p>Any initialization work that requires the ability to create OperationContexts should be done here rather than in the constructor. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a8dd4c2d5531ec89c7e7127f8d94a7cff">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a11e4508c71689c46509eef948568ecff">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="afc70f10ab115ffb7a18a3d0189ac9176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc70f10ab115ffb7a18a3d0189ac9176">&#9670;&nbsp;</a></span>flushAllFiles()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int mongo::StorageEngine::flushAllFiles </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>number of files flushed </dd></dl>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a0643a23df3f939ba6aabdcd398282bef">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a05b153cbe3e51e8f0d6bb73a5641260b">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a2a426e68e950295b64ab3341471e1927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a426e68e950295b64ab3341471e1927">&#9670;&nbsp;</a></span>getAllCommittedTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual Timestamp mongo::StorageEngine::getAllCommittedTimestamp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the all committed timestamp. </p>
<p>All transactions with timestamps earlier than the all committed timestamp are committed. Only storage engines that support document level locking must provide an implementation. Other storage engines may provide a no-op implementation. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#ae3976e677847a97580c2bb6befc00a55">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#aaabc7c5da80acf5feced97c720e3d743">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a2e78f6f7c6fa5615b8a5f81f933cb3b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e78f6f7c6fa5615b8a5f81f933cb3b4">&#9670;&nbsp;</a></span>getDatabaseCatalogEntry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmongo_1_1DatabaseCatalogEntry.html">DatabaseCatalogEntry</a>* mongo::StorageEngine::getDatabaseCatalogEntry </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StringData&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the <a class="el" href="classmongo_1_1DatabaseCatalogEntry.html">DatabaseCatalogEntry</a> that describes the database indicated by 'db'. </p>
<p><a class="el" href="classmongo_1_1StorageEngine.html" title="The StorageEngine class is the top level interface for creating a new storage engine. ">StorageEngine</a> owns returned pointer. It should not be deleted by any caller. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#ab822088aef3e3e3582529644882ed5d7">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#ad7d128a74c0be66ebee486ea3b87b8d3">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a83f7e872d15697c9c3bf50ed12964735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83f7e872d15697c9c3bf50ed12964735">&#9670;&nbsp;</a></span>getLastStableCheckpointTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual boost::optional&lt;Timestamp&gt; mongo::StorageEngine::getLastStableCheckpointTimestamp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a timestamp that is guaranteed to be persisted to disk in a checkpoint. </p>
<p>Returns boost::none if there is no stable checkpoint. This method should return at least the value of <code>getRecoveryTimestamp</code> if the node started from a stable checkpoint. fasserts if <a class="el" href="classmongo_1_1StorageEngine.html#aab3130a17adcd7174e9ad92af9024668" title="Returns whether the storage engine supports &quot;recover to stable timestamp&quot;. ">StorageEngine::supportsRecoverToStableTimestamp()</a> would return false. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#ac1b6d3d99952dfa1169ad86cd29af6c3">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="a79930a6f501a2ad71b942f76bc5bb74f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79930a6f501a2ad71b942f76bc5bb74f">&#9670;&nbsp;</a></span>getRecoveryTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual boost::optional&lt;Timestamp&gt; mongo::StorageEngine::getRecoveryTimestamp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the stable timestamp that the storage engine recovered to on startup. </p>
<p>If the recovery point was not stable, returns "none". fasserts if <a class="el" href="classmongo_1_1StorageEngine.html#aab3130a17adcd7174e9ad92af9024668" title="Returns whether the storage engine supports &quot;recover to stable timestamp&quot;. ">StorageEngine::supportsRecoverToStableTimestamp()</a> would return false. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a7fa0a466e7cec30e3b96a8d9cd9f5271">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="a620e7d61feab83f9d80c9edcc68d2cc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a620e7d61feab83f9d80c9edcc68d2cc2">&#9670;&nbsp;</a></span>getSnapshotManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmongo_1_1SnapshotManager.html">SnapshotManager</a>* mongo::StorageEngine::getSnapshotManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the <a class="el" href="classmongo_1_1SnapshotManager.html" title="Manages snapshots that can be read from at a later time. ">SnapshotManager</a> for this <a class="el" href="classmongo_1_1StorageEngine.html" title="The StorageEngine class is the top level interface for creating a new storage engine. ">StorageEngine</a> or NULL if not supported. </p>
<p>Pointer remains owned by the <a class="el" href="classmongo_1_1StorageEngine.html" title="The StorageEngine class is the top level interface for creating a new storage engine. ">StorageEngine</a>, not the caller. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a377ce0da69a9c3e26730e372422e42ca">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="af8292fa3ea82b903c56713db94daff6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8292fa3ea82b903c56713db94daff6a">&#9670;&nbsp;</a></span>isCacheUnderPressure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::isCacheUnderPressure </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indicates whether the storage engine cache is under pressure. </p>
<p>Retrieves a cache pressure value in the range [0, 100] from the storage engine, and compares it against storageGlobalParams.cachePressureThreshold, a dynamic server parameter, to determine whether cache pressure is too high. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#aaaa1f9ea2415ae884bea00713f4fc145">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="ad11089c3879e353ffaaf82e0f5c1d1f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad11089c3879e353ffaaf82e0f5c1d1f4">&#9670;&nbsp;</a></span>isDurable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::isDurable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether the engine supports a journalling concept or not. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a44abd6d6916e8477059ba021a7e306c2">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a8b7df1455b2c0e1d7b6c0103e21e8624">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a0d78f2fc178a5b1d07f3dbd995b8481e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d78f2fc178a5b1d07f3dbd995b8481e">&#9670;&nbsp;</a></span>isEphemeral()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::isEphemeral </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if the engine does not persist data to disk; false otherwise. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a5ca83c96ec70ce6a6bd32f6543f26a6e">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#aa779b0bee11584aaf8ec6d2aad4ca4b8">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a33bb304280d13f9526986c44fed3a7ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33bb304280d13f9526986c44fed3a7ca">&#9670;&nbsp;</a></span>isMmapV1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::isMmapV1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Only MMAPv1 should override this and return true to trigger MMAPv1-specific behavior. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1MMAPV1Engine.html#a43a180e057a84fdafb03a0eaff6fe536">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a9a90adedcbda8f43a80878e86b55da85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a90adedcbda8f43a80878e86b55da85">&#9670;&nbsp;</a></span>listDatabases()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::listDatabases </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>out</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List the databases stored in this storage engine. </p>
<p>XXX: why doesn't this take OpCtx? </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a459fbfd21e303bcb091995baf461d68d">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a7db0b44be79e733162601483ccdc809f">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a85e34ad431938728c6298468ecc7da53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85e34ad431938728c6298468ecc7da53">&#9670;&nbsp;</a></span>loadCatalog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::loadCatalog </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Populates and tears down in-memory data structures, respectively. </p>
<p>Only required for storage engines that support <a class="el" href="classmongo_1_1StorageEngine.html#a5fcc405b3d23c6164bde892026f66e94" title="Recovers the storage engine state to the last stable timestamp. ">recoverToStableTimestamp()</a>.</p>
<p>Must be called with the global lock acquired in exclusive mode. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a5169d88d3a3b389a4beabdf93e2613e8">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="ac9ab3dbc3ba656ac00481210a2ce8c45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9ab3dbc3ba656ac00481210a2ce8c45">&#9670;&nbsp;</a></span>newRecoveryUnit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmongo_1_1RecoveryUnit.html">RecoveryUnit</a>* mongo::StorageEngine::newRecoveryUnit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a new interface to the storage engine's recovery unit. </p>
<p>The recovery unit is the durability interface. For details, see <a class="el" href="recovery__unit_8h.html">recovery_unit.h</a></p>
<p>Caller owns the returned pointer. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a99ef27c813b8139a9e8187eb29cc99c1">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#ab7384e04569060f189589b5a802af7f9">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a4e7099c6ec62f2de75cd9d018c08e30a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e7099c6ec62f2de75cd9d018c08e30a">&#9670;&nbsp;</a></span>reconcileCatalogAndIdents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmongo_1_1StatusWith.html">StatusWith</a>&lt;std::vector&lt;<a class="el" href="classmongo_1_1StorageEngine.html#ae64a0ea2f55ed12186a2aee8a34c793b">CollectionIndexNamePair</a>&gt; &gt; mongo::StorageEngine::reconcileCatalogAndIdents </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Drop abandoned idents. </p>
<p>In the successful case, returns a list of collection, index name pairs to rebuild. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#ab9a72678b41b432feb90b1c67322214c">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="a5fcc405b3d23c6164bde892026f66e94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fcc405b3d23c6164bde892026f66e94">&#9670;&nbsp;</a></span>recoverToStableTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmongo_1_1StatusWith.html">StatusWith</a>&lt;Timestamp&gt; mongo::StorageEngine::recoverToStableTimestamp </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recovers the storage engine state to the last stable timestamp. </p>
<p>"Stable" in this case refers to a timestamp that is guaranteed to never be rolled back. The stable timestamp used should be one provided by <a class="el" href="classmongo_1_1StorageEngine.html#ae1c5cec571e7cb649c4c7b2e56df2469" title="Sets the highest timestamp at which the storage engine is allowed to take a checkpoint. ">StorageEngine::setStableTimestamp()</a>.</p>
<p>The "local" database is exempt and should not roll back any state except for "local.replset.minvalid" which must roll back to the last stable timestamp.</p>
<p>If successful, returns the timestamp that the storage engine recovered to.</p>
<p>fasserts if <a class="el" href="classmongo_1_1StorageEngine.html#aab3130a17adcd7174e9ad92af9024668" title="Returns whether the storage engine supports &quot;recover to stable timestamp&quot;. ">StorageEngine::supportsRecoverToStableTimestamp()</a> would return false. Returns a bad status if there is no stable timestamp to recover to.</p>
<p>It is illegal to call this concurrently with <code>setStableTimestamp</code> or <code>setInitialDataTimestamp</code>. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#aa93479f84ede416f282189d2b597c665">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="afeb3b3983813f900f61a4389602d5007"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeb3b3983813f900f61a4389602d5007">&#9670;&nbsp;</a></span>repairRecordStore()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a> mongo::StorageEngine::repairRecordStore </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recover as much data as possible from a potentially corrupt <a class="el" href="classmongo_1_1RecordStore.html" title="An abstraction used for storing documents in a collection or entries in an index. ...">RecordStore</a>. </p>
<p>This only recovers the record data, not indexes or anything else.</p>
<p>Generally, this method should not be called directly except by the repairDatabase() free function.</p>
<p>NOTE: MMAPv1 does not support this method and has its own repairDatabase() method. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a8265d01f486d17f39c4a9ed1d4863018">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a486fa37132eb18bc7589d2a2a42076ce">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a9c27216fc7815098dddaf7342749a4f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c27216fc7815098dddaf7342749a4f8">&#9670;&nbsp;</a></span>replicationBatchIsComplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::replicationBatchIsComplete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Notifies the storage engine that a replication batch has completed. </p>
<p>This means that all the writes associated with the oplog entries in the batch are finished and no new writes with timestamps associated with those oplog entries will show up in the future. This function can be used to ensure oplog visibility rules are not broken, for example. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a06d0877dd1dbd5689bd8a9aaf071e7a7">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="a11c01bfd4089ee9fb2bd05753b900c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c01bfd4089ee9fb2bd05753b900c56">&#9670;&nbsp;</a></span>setCachePressureForTest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::setCachePressureForTest </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pressure</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For unit tests only. </p>
<p>Sets the cache pressure value with which <a class="el" href="classmongo_1_1StorageEngine.html#af8292fa3ea82b903c56713db94daff6a" title="Indicates whether the storage engine cache is under pressure. ">isCacheUnderPressure()</a> evalutates to 'pressure'. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a2fd892fd4dab10fe3ac6b6d6e9cedc5b">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="ae382900644bc641160eb784aec54b873"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae382900644bc641160eb784aec54b873">&#9670;&nbsp;</a></span>setInitialDataTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::setInitialDataTimestamp </td>
          <td>(</td>
          <td class="paramtype">Timestamp&#160;</td>
          <td class="paramname"><em>timestamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tells the storage engine the timestamp of the data at startup. </p>
<p>This is necessary because timestamps are not persisted in the storage layer. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a15cb6aea949b1f30a7275125ae11c33e">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="ade3508d474e1fd9a168085a8a4d73828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade3508d474e1fd9a168085a8a4d73828">&#9670;&nbsp;</a></span>setJournalListener()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::setJournalListener </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmongo_1_1JournalListener.html">JournalListener</a> *&#160;</td>
          <td class="paramname"><em>jl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets a new <a class="el" href="classmongo_1_1JournalListener.html" title="This class allows for the storageEngine to alert the rest of the system about journaled write progres...">JournalListener</a>, which is used by the storage engine to alert the rest of the system about journaled write progress. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#af3a16c8a5543d53ddccae6b0a6e754c9">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#a6af850835385a7eb5553197ad0ab5841">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="a69d28bc4cdfbfea2083f822c13207ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69d28bc4cdfbfea2083f822c13207ff1">&#9670;&nbsp;</a></span>setOldestTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::setOldestTimestamp </td>
          <td>(</td>
          <td class="paramtype">Timestamp&#160;</td>
          <td class="paramname"><em>timestamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the oldest timestamp for which the storage engine must maintain snapshot history through. </p>
<p>Additionally, all future writes must be newer or equal to this value. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a7eab16896c324815ce60b87ef4b51926">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="a545160909125b61e22400d775b43ec8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a545160909125b61e22400d775b43ec8c">&#9670;&nbsp;</a></span>setOldestTimestampFromStable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::setOldestTimestampFromStable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Uses the current stable timestamp to set the oldest timestamp for which the storage engine must maintain snapshot history through. </p>
<p>oldest_timestamp will be set to stable_timestamp adjusted by 'targetSnapshotHistoryWindowInSeconds' to create a window of available snapshots on the storage engine from oldest to stable. Furthermore, oldest_timestamp will never be set ahead of the oplog read timestamp, ensuring the oplog reader's 'read_timestamp' can always be serviced. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#aa6ad776348f33da1925683b9a707bf41">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="ae1c5cec571e7cb649c4c7b2e56df2469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1c5cec571e7cb649c4c7b2e56df2469">&#9670;&nbsp;</a></span>setStableTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::StorageEngine::setStableTimestamp </td>
          <td>(</td>
          <td class="paramtype">Timestamp&#160;</td>
          <td class="paramname"><em>timestamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the highest timestamp at which the storage engine is allowed to take a checkpoint. </p>
<p>This timestamp can never decrease, and thus should be a timestamp that can never roll back. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#ae2ffeb5f83e76549076a69047e8f6ae5">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="a64bee4921853cd93667987cc98858886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64bee4921853cd93667987cc98858886">&#9670;&nbsp;</a></span>supportsCappedCollections()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::supportsCappedCollections </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether the storage engine supports capped collections. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a7d826367fbf5ea91e491c0bae1a85995">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="a97a5327723286b781a9d735a1bf80b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97a5327723286b781a9d735a1bf80b46">&#9670;&nbsp;</a></span>supportsDBLocking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::supportsDBLocking </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether the storage engine supports locking at a database level. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a9bf861bbd657f3769a66296835e011af">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="aaf0dfc56e0509914e839c8587fd0ee7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf0dfc56e0509914e839c8587fd0ee7d">&#9670;&nbsp;</a></span>supportsDocLocking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::supportsDocLocking </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether the storage engine supports its own locking locking below the collection level. </p>
<p>If the engine returns true, MongoDB will acquire intent locks down to the collection level and will assume that the engine will ensure consistency at the level of documents. If false, MongoDB will lock the entire collection in Shared/Exclusive mode for read/write operations respectively. </p>

<p>Implemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a0f54163355b5b97e130344dfdbd43534">mongo::KVStorageEngine</a>, and <a class="el" href="classmongo_1_1MMAPV1Engine.html#aafd4179b7d2fe9a5c32d7875e396b3bf">mongo::MMAPV1Engine</a>.</p>

</div>
</div>
<a id="aacf06242a2aed0d1c4a54fd3e1460852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf06242a2aed0d1c4a54fd3e1460852">&#9670;&nbsp;</a></span>supportsReadConcernSnapshot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::supportsReadConcernSnapshot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if the storage engine supports the readConcern level "snapshot". </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#aade080cb1b7268484fc1397ea795c51b">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<a id="aab3130a17adcd7174e9ad92af9024668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab3130a17adcd7174e9ad92af9024668">&#9670;&nbsp;</a></span>supportsRecoverToStableTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::StorageEngine::supportsRecoverToStableTimestamp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether the storage engine supports "recover to stable timestamp". </p>
<p>Returns true if the storage engine supports "recover to stable timestamp" but does not currently have a stable timestamp. In that case <a class="el" href="classmongo_1_1StorageEngine.html#a5fcc405b3d23c6164bde892026f66e94" title="Recovers the storage engine state to the last stable timestamp. ">StorageEngine::recoverToStableTimestamp()</a> will return a bad status. </p>

<p>Reimplemented in <a class="el" href="classmongo_1_1KVStorageEngine.html#a7060f77d244091c37f9ebdf62ce23c0b">mongo::KVStorageEngine</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/louis/git/mongo/src/mongo/db/storage/<a class="el" href="storage__engine_8h_source.html">storage_engine.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemongo.html">mongo</a></li><li class="navelem"><a class="el" href="classmongo_1_1StorageEngine.html">StorageEngine</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
