<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Storage Engine API: mongo::HeapRecordStoreBtreeRecoveryUnit Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link href="mongodb.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="mongodb-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Storage Engine API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mongo::HeapRecordStoreBtreeRecoveryUnit Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a> for <a class="el" href="classmongo_1_1HeapRecordStoreBtree.html" title="A RecordStore that stores all data on the heap. ">HeapRecordStoreBtree</a>, this is for testing btree only.  
 <a href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="heap__record__store__btree_8h_source.html">heap_record_store_btree.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for mongo::HeapRecordStoreBtreeRecoveryUnit:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.png" usemap="#mongo::HeapRecordStoreBtreeRecoveryUnit_map" alt=""/>
  <map id="mongo::HeapRecordStoreBtreeRecoveryUnit_map" name="mongo::HeapRecordStoreBtreeRecoveryUnit_map">
<area href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. " alt="mongo::RecoveryUnit" shape="rect" coords="0,0,262,24"/>
</map>
 </div></div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a> for <a class="el" href="classmongo_1_1HeapRecordStoreBtree.html" title="A RecordStore that stores all data on the heap. ">HeapRecordStoreBtree</a>, this is for testing btree only. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmongo_1_1HeapRecordStoreBtreeRecoveryUnit_1_1InsertEntry.html">InsertEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmongo_1_1HeapRecordStoreBtreeRecoveryUnit_1_1ModEntry.html">ModEntry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acfa9dc90cac1e55fc90f66ba5ce91fb7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#acfa9dc90cac1e55fc90f66ba5ce91fb7">beginUnitOfWork</a> (OperationContext *<a class="el" href="namespacemongo.html#a15b23ef1d9a7f6cdadbf866f1e8e5043">opCtx</a>) final</td></tr>
<tr class="memdesc:acfa9dc90cac1e55fc90f66ba5ce91fb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks the beginning of a unit of work.  <a href="#acfa9dc90cac1e55fc90f66ba5ce91fb7">More...</a><br /></td></tr>
<tr class="separator:acfa9dc90cac1e55fc90f66ba5ce91fb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a566945213dbeaa99ece68b528e3ecc98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a566945213dbeaa99ece68b528e3ecc98">commitUnitOfWork</a> () final</td></tr>
<tr class="memdesc:a566945213dbeaa99ece68b528e3ecc98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks the end of a unit of work and commits all changes registered by calls to onCommit or registerChange, in order.  <a href="#a566945213dbeaa99ece68b528e3ecc98">More...</a><br /></td></tr>
<tr class="separator:a566945213dbeaa99ece68b528e3ecc98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eff18f8ed55202484df1604059067b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a0eff18f8ed55202484df1604059067b1">abortUnitOfWork</a> () final</td></tr>
<tr class="memdesc:a0eff18f8ed55202484df1604059067b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks the end of a unit of work and rolls back all changes registered by calls to onRollback or registerChange, in reverse order.  <a href="#a0eff18f8ed55202484df1604059067b1">More...</a><br /></td></tr>
<tr class="separator:a0eff18f8ed55202484df1604059067b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb4b1e2a801522ce434ae1182eaaf56e"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#aeb4b1e2a801522ce434ae1182eaaf56e">waitUntilDurable</a> ()</td></tr>
<tr class="memdesc:aeb4b1e2a801522ce434ae1182eaaf56e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits until all commits that happened before this call are durable in the journal.  <a href="#aeb4b1e2a801522ce434ae1182eaaf56e">More...</a><br /></td></tr>
<tr class="separator:aeb4b1e2a801522ce434ae1182eaaf56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6336bd1c36ebf3eb0bd6a80f665f3c6"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#ab6336bd1c36ebf3eb0bd6a80f665f3c6">abandonSnapshot</a> ()</td></tr>
<tr class="memdesc:ab6336bd1c36ebf3eb0bd6a80f665f3c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">If there is an open transaction, it is closed.  <a href="#ab6336bd1c36ebf3eb0bd6a80f665f3c6">More...</a><br /></td></tr>
<tr class="separator:ab6336bd1c36ebf3eb0bd6a80f665f3c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a525ac8a1c47dc74749b81f63bc684148"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a525ac8a1c47dc74749b81f63bc684148">registerChange</a> (<a class="el" href="classmongo_1_1RecoveryUnit_1_1Change.html">Change</a> *change)</td></tr>
<tr class="memdesc:a525ac8a1c47dc74749b81f63bc684148"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a> takes ownership of the change.  <a href="#a525ac8a1c47dc74749b81f63bc684148">More...</a><br /></td></tr>
<tr class="separator:a525ac8a1c47dc74749b81f63bc684148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42109c714134ba40a448efcf7014f272"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a42109c714134ba40a448efcf7014f272">writingPtr</a> (<a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> *<a class="el" href="ephemeral__for__test__record__store__test_8cpp.html#a7b0b6386ed9af4d133c80f6322cc60dc">data</a>, size_t len)</td></tr>
<tr class="memdesc:a42109c714134ba40a448efcf7014f272"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare that the data at [x, x + len) is being written.  <a href="#a42109c714134ba40a448efcf7014f272">More...</a><br /></td></tr>
<tr class="separator:a42109c714134ba40a448efcf7014f272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad19ae3818b6f738093cc90f9a23b2b5c"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#ad19ae3818b6f738093cc90f9a23b2b5c">setRollbackWritesDisabled</a> ()</td></tr>
<tr class="memdesc:ad19ae3818b6f738093cc90f9a23b2b5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a flag that declares this <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a> will skip rolling back writes, for the duration of the current outermost <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a>.  <a href="#ad19ae3818b6f738093cc90f9a23b2b5c">More...</a><br /></td></tr>
<tr class="separator:ad19ae3818b6f738093cc90f9a23b2b5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd3330cd87ff83aa8a2a13e6d5b2e51c"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmongo_1_1SnapshotId.html">SnapshotId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#afd3330cd87ff83aa8a2a13e6d5b2e51c">getSnapshotId</a> () const</td></tr>
<tr class="memdesc:afd3330cd87ff83aa8a2a13e6d5b2e51c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the local <a class="el" href="classmongo_1_1SnapshotId.html">SnapshotId</a>.  <a href="#afd3330cd87ff83aa8a2a13e6d5b2e51c">More...</a><br /></td></tr>
<tr class="separator:afd3330cd87ff83aa8a2a13e6d5b2e51c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48b681fd6d4e46077d8002eeb4c67a83"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a48b681fd6d4e46077d8002eeb4c67a83">setOrderedCommit</a> (bool orderedCommit)</td></tr>
<tr class="separator:a48b681fd6d4e46077d8002eeb4c67a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac70196522b35eaa495ab48a9bbb53c48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#ac70196522b35eaa495ab48a9bbb53c48">notifyInsert</a> (<a class="el" href="classmongo_1_1HeapRecordStoreBtree.html">HeapRecordStoreBtree</a> *<a class="el" href="wiredtiger__standard__record__store__test_8cpp.html#ace772d9f1f47f28930b20743f0415276">rs</a>, const RecordId &amp;loc)</td></tr>
<tr class="separator:ac70196522b35eaa495ab48a9bbb53c48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classmongo_1_1RecoveryUnit"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classmongo_1_1RecoveryUnit')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classmongo_1_1RecoveryUnit.html">mongo::RecoveryUnit</a></td></tr>
<tr class="memitem:a78ccf94669747f5a9ebeab51fce73e0b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a78ccf94669747f5a9ebeab51fce73e0b">~RecoveryUnit</a> ()</td></tr>
<tr class="separator:a78ccf94669747f5a9ebeab51fce73e0b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac93536b0d28f2e09e1dea494b427d135 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#ac93536b0d28f2e09e1dea494b427d135">prepareUnitOfWork</a> ()</td></tr>
<tr class="memdesc:ac93536b0d28f2e09e1dea494b427d135 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transitions the active unit of work to the "prepared" state.  <a href="classmongo_1_1RecoveryUnit.html#ac93536b0d28f2e09e1dea494b427d135">More...</a><br /></td></tr>
<tr class="separator:ac93536b0d28f2e09e1dea494b427d135 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7de9852b198105e4448964bbd681a7 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a7b7de9852b198105e4448964bbd681a7">setIgnorePrepared</a> (bool ignore)</td></tr>
<tr class="memdesc:a7b7de9852b198105e4448964bbd681a7 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets whether or not to ignore prepared transactions if supported by this storage engine.  <a href="classmongo_1_1RecoveryUnit.html#a7b7de9852b198105e4448964bbd681a7">More...</a><br /></td></tr>
<tr class="separator:a7b7de9852b198105e4448964bbd681a7 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfbe972c6eb640ddf1660b37bd236888 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#adfbe972c6eb640ddf1660b37bd236888">waitUntilUnjournaledWritesDurable</a> ()</td></tr>
<tr class="memdesc:adfbe972c6eb640ddf1660b37bd236888 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlike <code>waitUntilDurable</code>, this method takes a stable checkpoint, making durable any writes on unjournaled tables that are behind the current stable timestamp.  <a href="classmongo_1_1RecoveryUnit.html#adfbe972c6eb640ddf1660b37bd236888">More...</a><br /></td></tr>
<tr class="separator:adfbe972c6eb640ddf1660b37bd236888 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7e155dd4639d64c3780a8e33b1229c2 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#ab7e155dd4639d64c3780a8e33b1229c2">preallocateSnapshot</a> ()</td></tr>
<tr class="memdesc:ab7e155dd4639d64c3780a8e33b1229c2 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Informs the <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a> that a snapshot will be needed soon, if one was not already established.  <a href="classmongo_1_1RecoveryUnit.html#ab7e155dd4639d64c3780a8e33b1229c2">More...</a><br /></td></tr>
<tr class="separator:ab7e155dd4639d64c3780a8e33b1229c2 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa06eae806c652b8e9140a3e22c0f6d32 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#aa06eae806c652b8e9140a3e22c0f6d32">obtainMajorityCommittedSnapshot</a> ()</td></tr>
<tr class="memdesc:aa06eae806c652b8e9140a3e22c0f6d32 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains a majority committed snapshot.  <a href="classmongo_1_1RecoveryUnit.html#aa06eae806c652b8e9140a3e22c0f6d32">More...</a><br /></td></tr>
<tr class="separator:aa06eae806c652b8e9140a3e22c0f6d32 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eca651df7de7474ca04f9b58e605047 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual boost::optional&lt; Timestamp &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a3eca651df7de7474ca04f9b58e605047">getPointInTimeReadTimestamp</a> () const</td></tr>
<tr class="memdesc:a3eca651df7de7474ca04f9b58e605047 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Timestamp being used by this recovery unit or boost::none if not reading from a point in time.  <a href="classmongo_1_1RecoveryUnit.html#a3eca651df7de7474ca04f9b58e605047">More...</a><br /></td></tr>
<tr class="separator:a3eca651df7de7474ca04f9b58e605047 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a741651c20eba9f946bcf58908f780c inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#a7dd53a44ec884164bc07ed073e9f31da">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a2a741651c20eba9f946bcf58908f780c">setTimestamp</a> (Timestamp timestamp)</td></tr>
<tr class="memdesc:a2a741651c20eba9f946bcf58908f780c inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a timestamp to assign to future writes in a transaction.  <a href="classmongo_1_1RecoveryUnit.html#a2a741651c20eba9f946bcf58908f780c">More...</a><br /></td></tr>
<tr class="separator:a2a741651c20eba9f946bcf58908f780c inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c1fe82af78f29a8d45c60b74682216 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#af7c1fe82af78f29a8d45c60b74682216">setCommitTimestamp</a> (Timestamp timestamp)</td></tr>
<tr class="memdesc:af7c1fe82af78f29a8d45c60b74682216 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a timestamp that will be assigned to all future writes on this <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a> until <a class="el" href="classmongo_1_1RecoveryUnit.html#a2f4f847062bc4bef9f4478ff04f9c3e1">clearCommitTimestamp()</a> is called.  <a href="classmongo_1_1RecoveryUnit.html#af7c1fe82af78f29a8d45c60b74682216">More...</a><br /></td></tr>
<tr class="separator:af7c1fe82af78f29a8d45c60b74682216 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4f847062bc4bef9f4478ff04f9c3e1 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a2f4f847062bc4bef9f4478ff04f9c3e1">clearCommitTimestamp</a> ()</td></tr>
<tr class="separator:a2f4f847062bc4bef9f4478ff04f9c3e1 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa109e1b7f241e111e955ad86ce5f0c1f inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual Timestamp&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#aa109e1b7f241e111e955ad86ce5f0c1f">getCommitTimestamp</a> ()</td></tr>
<tr class="separator:aa109e1b7f241e111e955ad86ce5f0c1f inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05d80b9df7ebc42b4a31d215785cbff8 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a05d80b9df7ebc42b4a31d215785cbff8">setPrepareTimestamp</a> (Timestamp timestamp)</td></tr>
<tr class="memdesc:a05d80b9df7ebc42b4a31d215785cbff8 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a prepare timestamp for the current transaction.  <a href="classmongo_1_1RecoveryUnit.html#a05d80b9df7ebc42b4a31d215785cbff8">More...</a><br /></td></tr>
<tr class="separator:a05d80b9df7ebc42b4a31d215785cbff8 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a89e3d20bf1483f88a1db6e888c91b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a90a89e3d20bf1483f88a1db6e888c91b">setTimestampReadSource</a> (<a class="el" href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4">ReadSource</a> source, boost::optional&lt; Timestamp &gt; provided=boost::none)</td></tr>
<tr class="memdesc:a90a89e3d20bf1483f88a1db6e888c91b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets which timestamp to use for read transactions.  <a href="classmongo_1_1RecoveryUnit.html#a90a89e3d20bf1483f88a1db6e888c91b">More...</a><br /></td></tr>
<tr class="separator:a90a89e3d20bf1483f88a1db6e888c91b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ca99643741926924e08d96ddcc2255 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4">ReadSource</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#af9ca99643741926924e08d96ddcc2255">getTimestampReadSource</a> () const</td></tr>
<tr class="separator:af9ca99643741926924e08d96ddcc2255 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6327788abf54b8cb56fd92aff3e5212b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memTemplParams" colspan="2">template&lt;typename Callback &gt; </td></tr>
<tr class="memitem:a6327788abf54b8cb56fd92aff3e5212b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a6327788abf54b8cb56fd92aff3e5212b">onRollback</a> (Callback callback)</td></tr>
<tr class="memdesc:a6327788abf54b8cb56fd92aff3e5212b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a callback to be called if the current <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a> rolls back.  <a href="classmongo_1_1RecoveryUnit.html#a6327788abf54b8cb56fd92aff3e5212b">More...</a><br /></td></tr>
<tr class="separator:a6327788abf54b8cb56fd92aff3e5212b inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e39b3240412719df98678e9027a576 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memTemplParams" colspan="2">template&lt;typename Callback &gt; </td></tr>
<tr class="memitem:a23e39b3240412719df98678e9027a576 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a23e39b3240412719df98678e9027a576">onCommit</a> (Callback callback)</td></tr>
<tr class="memdesc:a23e39b3240412719df98678e9027a576 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a callback to be called if the current <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a> commits.  <a href="classmongo_1_1RecoveryUnit.html#a23e39b3240412719df98678e9027a576">More...</a><br /></td></tr>
<tr class="separator:a23e39b3240412719df98678e9027a576 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e0890e1bdbde55db22f0a9c6b66d07 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">int &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a56e0890e1bdbde55db22f0a9c6b66d07">writingInt</a> (int &amp;d)</td></tr>
<tr class="memdesc:a56e0890e1bdbde55db22f0a9c6b66d07 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare write intent for an int.  <a href="classmongo_1_1RecoveryUnit.html#a56e0890e1bdbde55db22f0a9c6b66d07">More...</a><br /></td></tr>
<tr class="separator:a56e0890e1bdbde55db22f0a9c6b66d07 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6115a1b56fb07dba55a1b46df9ab755 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ac6115a1b56fb07dba55a1b46df9ab755 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memTemplItemLeft" align="right" valign="top">T *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#ac6115a1b56fb07dba55a1b46df9ab755">writing</a> (T *x)</td></tr>
<tr class="memdesc:ac6115a1b56fb07dba55a1b46df9ab755 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="mdescLeft">&#160;</td><td class="mdescRight">A templated helper for writingPtr.  <a href="classmongo_1_1RecoveryUnit.html#ac6115a1b56fb07dba55a1b46df9ab755">More...</a><br /></td></tr>
<tr class="separator:ac6115a1b56fb07dba55a1b46df9ab755 inherit pub_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a10f25c10f8519ee6d6a835bfad5cb1ca"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a10f25c10f8519ee6d6a835bfad5cb1ca">notifyInsert</a> (OperationContext *ctx, <a class="el" href="classmongo_1_1HeapRecordStoreBtree.html">HeapRecordStoreBtree</a> *<a class="el" href="wiredtiger__standard__record__store__test_8cpp.html#ace772d9f1f47f28930b20743f0415276">rs</a>, const RecordId &amp;loc)</td></tr>
<tr class="separator:a10f25c10f8519ee6d6a835bfad5cb1ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab9f0db2cce2b00130b6f7b6807ba9234"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structmongo_1_1HeapRecordStoreBtreeRecoveryUnit_1_1InsertEntry.html">InsertEntry</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#ab9f0db2cce2b00130b6f7b6807ba9234">_insertions</a></td></tr>
<tr class="separator:ab9f0db2cce2b00130b6f7b6807ba9234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2c1630715347e5445b6638baddf787"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structmongo_1_1HeapRecordStoreBtreeRecoveryUnit_1_1ModEntry.html">ModEntry</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a2f2c1630715347e5445b6638baddf787">_mods</a></td></tr>
<tr class="separator:a2f2c1630715347e5445b6638baddf787"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classmongo_1_1RecoveryUnit"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classmongo_1_1RecoveryUnit')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classmongo_1_1RecoveryUnit.html">mongo::RecoveryUnit</a></td></tr>
<tr class="memitem:ab73d986cec10146d72945aa3a11b87a4 inherit pub_types_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4">ReadSource</a> { <br />
&#160;&#160;<a class="el" href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4a0df1e74d10a350da6c99b33538d09ee6">kNone</a>, 
<a class="el" href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4a783bd0f6356d0eaacedb2fa325e73cd8">kMajorityCommitted</a>, 
<a class="el" href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4a6ac3c436cd3a401e9f9b8d8c4853b5d7">kLastApplied</a>, 
<a class="el" href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4ab81b778c3f74a093f587f3d95a600c2e">kLastAppliedSnapshot</a>, 
<br />
&#160;&#160;<a class="el" href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4a6da9860a7e480d4d7f2cad14e29135e0">kProvided</a>
<br />
 }<tr class="memdesc:ab73d986cec10146d72945aa3a11b87a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ReadSource indicates which exteral or provided timestamp to read from for future transactions.  <a href="classmongo_1_1RecoveryUnit.html#ab73d986cec10146d72945aa3a11b87a4">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:ab73d986cec10146d72945aa3a11b87a4 inherit pub_types_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classmongo_1_1RecoveryUnit"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classmongo_1_1RecoveryUnit')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classmongo_1_1RecoveryUnit.html">mongo::RecoveryUnit</a></td></tr>
<tr class="memitem:a884f48e4987b3543709aaf5e53b914a2 inherit pro_methods_classmongo_1_1RecoveryUnit"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1RecoveryUnit.html#a884f48e4987b3543709aaf5e53b914a2">RecoveryUnit</a> ()</td></tr>
<tr class="separator:a884f48e4987b3543709aaf5e53b914a2 inherit pro_methods_classmongo_1_1RecoveryUnit"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab6336bd1c36ebf3eb0bd6a80f665f3c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6336bd1c36ebf3eb0bd6a80f665f3c6">&#9670;&nbsp;</a></span>abandonSnapshot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::abandonSnapshot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If there is an open transaction, it is closed. </p>
<p>On return no transaction is active. This cannot be called inside of a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a>, and should fail if it is. </p>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#ae0b67bef4574ebe15bb418c658e2d1ac">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="a0eff18f8ed55202484df1604059067b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0eff18f8ed55202484df1604059067b1">&#9670;&nbsp;</a></span>abortUnitOfWork()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::abortUnitOfWork </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks the end of a unit of work and rolls back all changes registered by calls to onRollback or registerChange, in reverse order. </p>
<p>Must be matched by exactly one preceding call to beginUnitOfWork.</p>
<p>Should be called through <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a> rather than directly. </p>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#a3bfbaa2f28b9ebe0b7774443b0d84481">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="acfa9dc90cac1e55fc90f66ba5ce91fb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfa9dc90cac1e55fc90f66ba5ce91fb7">&#9670;&nbsp;</a></span>beginUnitOfWork()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::beginUnitOfWork </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>opCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks the beginning of a unit of work. </p>
<p>Each call must be matched with exactly one call to either commitUnitOfWork or abortUnitOfWork.</p>
<p>Should be called through <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a> rather than directly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">opCtx</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#a6bf744451000b79e20b1f641d4b8aaf6">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="a566945213dbeaa99ece68b528e3ecc98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a566945213dbeaa99ece68b528e3ecc98">&#9670;&nbsp;</a></span>commitUnitOfWork()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::commitUnitOfWork </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marks the end of a unit of work and commits all changes registered by calls to onCommit or registerChange, in order. </p>
<p>Must be matched by exactly one preceding call to beginUnitOfWork.</p>
<p>Should be called through <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a> rather than directly. </p>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#abcdfa3cff074a147ca1d06fbdb84bef3">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="afd3330cd87ff83aa8a2a13e6d5b2e51c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd3330cd87ff83aa8a2a13e6d5b2e51c">&#9670;&nbsp;</a></span>getSnapshotId()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmongo_1_1SnapshotId.html">SnapshotId</a> mongo::HeapRecordStoreBtreeRecoveryUnit::getSnapshotId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the local <a class="el" href="classmongo_1_1SnapshotId.html">SnapshotId</a>. </p>
<p>It is only valid to compare SnapshotIds generated by a single <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a>.</p>
<p>This is unrelated to Timestamp which must be globally comparable. </p>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#a32b67f3be8c7aeb40d76d68e1f061bef">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="ac70196522b35eaa495ab48a9bbb53c48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac70196522b35eaa495ab48a9bbb53c48">&#9670;&nbsp;</a></span>notifyInsert() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::notifyInsert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmongo_1_1HeapRecordStoreBtree.html">HeapRecordStoreBtree</a> *&#160;</td>
          <td class="paramname"><em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RecordId &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a10f25c10f8519ee6d6a835bfad5cb1ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10f25c10f8519ee6d6a835bfad5cb1ca">&#9670;&nbsp;</a></span>notifyInsert() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::notifyInsert </td>
          <td>(</td>
          <td class="paramtype">OperationContext *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmongo_1_1HeapRecordStoreBtree.html">HeapRecordStoreBtree</a> *&#160;</td>
          <td class="paramname"><em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const RecordId &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a525ac8a1c47dc74749b81f63bc684148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a525ac8a1c47dc74749b81f63bc684148">&#9670;&nbsp;</a></span>registerChange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::registerChange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmongo_1_1RecoveryUnit_1_1Change.html">Change</a> *&#160;</td>
          <td class="paramname"><em>change</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a> takes ownership of the change. </p>
<p>The <a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a566945213dbeaa99ece68b528e3ecc98" title="Marks the end of a unit of work and commits all changes registered by calls to onCommit or registerCh...">commitUnitOfWork()</a> method calls the commit() method of each registered change in order of registration. The endUnitOfWork() method calls the rollback() method of each registered Change in reverse order of registration. Either will unregister and delete the changes.</p>
<p>The <a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#a525ac8a1c47dc74749b81f63bc684148" title="The RecoveryUnit takes ownership of the change. ">registerChange()</a> method may only be called when a <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a> is active, and may not be called during commit or rollback. </p>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#aa77394e746595779c6a0cf9dcb9333f6">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="a48b681fd6d4e46077d8002eeb4c67a83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48b681fd6d4e46077d8002eeb4c67a83">&#9670;&nbsp;</a></span>setOrderedCommit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::setOrderedCommit </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>orderedCommit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#a24196b6876e437df39cfb41757ad1b6b">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="ad19ae3818b6f738093cc90f9a23b2b5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad19ae3818b6f738093cc90f9a23b2b5c">&#9670;&nbsp;</a></span>setRollbackWritesDisabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::HeapRecordStoreBtreeRecoveryUnit::setRollbackWritesDisabled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets a flag that declares this <a class="el" href="classmongo_1_1RecoveryUnit.html" title="A RecoveryUnit is responsible for ensuring that data is persisted. ">RecoveryUnit</a> will skip rolling back writes, for the duration of the current outermost <a class="el" href="classmongo_1_1WriteUnitOfWork.html" title="The WriteUnitOfWork is an RAII type that begins a storage engine write unit of work on both the Locke...">WriteUnitOfWork</a>. </p>
<p>This function can only be called between a pair of unnested <a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html#acfa9dc90cac1e55fc90f66ba5ce91fb7" title="Marks the beginning of a unit of work. ">beginUnitOfWork()</a> / endUnitOfWork() calls. The flag is cleared when endUnitOfWork() is called. While the flag is set, rollback will skip rolling back writes, but custom rollback change functions are still called. Clearly, this functionality should only be used when writing to temporary collections that can be cleaned up externally. For example, foreground index builds write to a temporary collection; if something goes wrong that normally requires a rollback, we can instead clean up the index by dropping the entire index. Setting the flag may permit increased performance. </p>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#a91ccb0edb38fa25858e7b7a5a509fb93">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="aeb4b1e2a801522ce434ae1182eaaf56e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb4b1e2a801522ce434ae1182eaaf56e">&#9670;&nbsp;</a></span>waitUntilDurable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mongo::HeapRecordStoreBtreeRecoveryUnit::waitUntilDurable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Waits until all commits that happened before this call are durable in the journal. </p>
<p>Returns true, unless the storage engine cannot guarantee durability, which should never happen when isDurable() returned true. This cannot be called from inside a unit of work, and should fail if it is.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">durable</td><td>Whether or not the storage engine can guarantee durability. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#a91074d53f8e4147977bfd90cd8ffa392">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<a id="a42109c714134ba40a448efcf7014f272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42109c714134ba40a448efcf7014f272">&#9670;&nbsp;</a></span>writingPtr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> * mongo::HeapRecordStoreBtreeRecoveryUnit::writingPtr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Declare that the data at [x, x + len) is being written. </p>

<p>Implements <a class="el" href="classmongo_1_1RecoveryUnit.html#a1b23ef2f3a3a59eaee20ae616caca676">mongo::RecoveryUnit</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ab9f0db2cce2b00130b6f7b6807ba9234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9f0db2cce2b00130b6f7b6807ba9234">&#9670;&nbsp;</a></span>_insertions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structmongo_1_1HeapRecordStoreBtreeRecoveryUnit_1_1InsertEntry.html">InsertEntry</a>&gt; mongo::HeapRecordStoreBtreeRecoveryUnit::_insertions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f2c1630715347e5445b6638baddf787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f2c1630715347e5445b6638baddf787">&#9670;&nbsp;</a></span>_mods</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structmongo_1_1HeapRecordStoreBtreeRecoveryUnit_1_1ModEntry.html">ModEntry</a>&gt; mongo::HeapRecordStoreBtreeRecoveryUnit::_mods</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/louis/git/mongo/src/mongo/db/storage/mmap_v1/<a class="el" href="heap__record__store__btree_8h_source.html">heap_record_store_btree.h</a></li>
<li>/home/louis/git/mongo/src/mongo/db/storage/mmap_v1/<a class="el" href="heap__record__store__btree_8cpp.html">heap_record_store_btree.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemongo.html">mongo</a></li><li class="navelem"><a class="el" href="classmongo_1_1HeapRecordStoreBtreeRecoveryUnit.html">HeapRecordStoreBtreeRecoveryUnit</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
