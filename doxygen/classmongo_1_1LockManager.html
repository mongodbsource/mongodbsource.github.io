<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Storage Engine API: mongo::LockManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link href="mongodb.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="mongodb-logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Storage Engine API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classmongo_1_1LockManager.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classmongo_1_1LockManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mongo::LockManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Entry point for the lock manager scheduling functionality.  
 <a href="classmongo_1_1LockManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="lock__manager_8h_source.html">lock_manager.h</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Entry point for the lock manager scheduling functionality. </p>
<p>Don't use it directly, but instead go through the <a class="el" href="classmongo_1_1Locker.html" title="Interface for acquiring locks.">Locker</a> interface. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmongo_1_1LockManager_1_1Partition.html">Partition</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a244f9122cac2e35ca64106636ebf0cad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a244f9122cac2e35ca64106636ebf0cad">LockManager</a> ()</td></tr>
<tr class="separator:a244f9122cac2e35ca64106636ebf0cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9103fc87885ba6b3465248ad7721531"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#ae9103fc87885ba6b3465248ad7721531">~LockManager</a> ()</td></tr>
<tr class="separator:ae9103fc87885ba6b3465248ad7721531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ca10f4da1bffb5a0988f5affddd507"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#af54347edd3ad8dc00c6c27e0816e2dea">LockResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a91ca10f4da1bffb5a0988f5affddd507">lock</a> (<a class="el" href="classmongo_1_1ResourceId.html">ResourceId</a> resId, <a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *request, <a class="el" href="namespacemongo.html#a9a3ebc0a91ee78ba95fc1ef18a948a2b">LockMode</a> mode)</td></tr>
<tr class="memdesc:a91ca10f4da1bffb5a0988f5affddd507"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acquires lock on the specified resource in the specified mode and returns the outcome of the operation.  <a href="#a91ca10f4da1bffb5a0988f5affddd507">More...</a><br /></td></tr>
<tr class="separator:a91ca10f4da1bffb5a0988f5affddd507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ca72cf163a2b891d814527f9adc042"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#af54347edd3ad8dc00c6c27e0816e2dea">LockResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#ac9ca72cf163a2b891d814527f9adc042">convert</a> (<a class="el" href="classmongo_1_1ResourceId.html">ResourceId</a> resId, <a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *request, <a class="el" href="namespacemongo.html#a9a3ebc0a91ee78ba95fc1ef18a948a2b">LockMode</a> newMode)</td></tr>
<tr class="separator:ac9ca72cf163a2b891d814527f9adc042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28815c9331a810856b12ce10b88565fe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a28815c9331a810856b12ce10b88565fe">unlock</a> (<a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *request)</td></tr>
<tr class="memdesc:a28815c9331a810856b12ce10b88565fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrements the reference count of a previously locked request and if the reference count becomes zero, removes the request and proceeds to granting any conflicts.  <a href="#a28815c9331a810856b12ce10b88565fe">More...</a><br /></td></tr>
<tr class="separator:a28815c9331a810856b12ce10b88565fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8207d18c5f434eabcc9cfe4a4718853a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a8207d18c5f434eabcc9cfe4a4718853a">downgrade</a> (<a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *request, <a class="el" href="namespacemongo.html#a9a3ebc0a91ee78ba95fc1ef18a948a2b">LockMode</a> newMode)</td></tr>
<tr class="memdesc:a8207d18c5f434eabcc9cfe4a4718853a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Downgrades the mode in which an already granted request is held, without changing the reference count of the lock request.  <a href="#a8207d18c5f434eabcc9cfe4a4718853a">More...</a><br /></td></tr>
<tr class="separator:a8207d18c5f434eabcc9cfe4a4718853a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a335b2031ddbe964785d161345eb72d59"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a335b2031ddbe964785d161345eb72d59">cleanupUnusedLocks</a> ()</td></tr>
<tr class="memdesc:a335b2031ddbe964785d161345eb72d59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterates through all buckets and deletes all locks, which have no requests on them.  <a href="#a335b2031ddbe964785d161345eb72d59">More...</a><br /></td></tr>
<tr class="separator:a335b2031ddbe964785d161345eb72d59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3338bd7bfcbb398d628ac73860c20ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#aa3338bd7bfcbb398d628ac73860c20ad">dump</a> () const</td></tr>
<tr class="memdesc:aa3338bd7bfcbb398d628ac73860c20ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dumps the contents of all locks to the log.  <a href="#aa3338bd7bfcbb398d628ac73860c20ad">More...</a><br /></td></tr>
<tr class="separator:aa3338bd7bfcbb398d628ac73860c20ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b07f477174362f1596de6089d003c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#ad5b07f477174362f1596de6089d003c6">getLockInfoBSON</a> (const std::map&lt; <a class="el" href="namespacemongo.html#ad7b6e5bd2d44b9b4fe9031b23492c38a">LockerId</a>, BSONObj &gt; &amp;lockToClientMap, BSONObjBuilder *result)</td></tr>
<tr class="memdesc:ad5b07f477174362f1596de6089d003c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dumps the contents of all locks into a BSON object to be used in lockInfo command in the shell.  <a href="#ad5b07f477174362f1596de6089d003c6">More...</a><br /></td></tr>
<tr class="separator:ad5b07f477174362f1596de6089d003c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ad636a261ed7fb750564f886570c84866"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#ad636a261ed7fb750564f886570c84866">MONGO_DISALLOW_COPYING</a> (<a class="el" href="classmongo_1_1LockManager.html">LockManager</a>)</td></tr>
<tr class="separator:ad636a261ed7fb750564f886570c84866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec684525d5f75e793f2ed222f0d40664"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#aec684525d5f75e793f2ed222f0d40664">_getBucket</a> (<a class="el" href="classmongo_1_1ResourceId.html">ResourceId</a> resId) const</td></tr>
<tr class="memdesc:aec684525d5f75e793f2ed222f0d40664"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the bucket in which the particular resource must reside.  <a href="#aec684525d5f75e793f2ed222f0d40664">More...</a><br /></td></tr>
<tr class="separator:aec684525d5f75e793f2ed222f0d40664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a952ef126c6788402201c0a190b4a71f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmongo_1_1LockManager_1_1Partition.html">Partition</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a952ef126c6788402201c0a190b4a71f9">_getPartition</a> (<a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *request) const</td></tr>
<tr class="memdesc:a952ef126c6788402201c0a190b4a71f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the <a class="el" href="structmongo_1_1LockManager_1_1Partition.html">Partition</a> that a particular <a class="el" href="structmongo_1_1LockRequest.html" title="There is one of those entries per each request for a lock.">LockRequest</a> should use for intent locking.  <a href="#a952ef126c6788402201c0a190b4a71f9">More...</a><br /></td></tr>
<tr class="separator:a952ef126c6788402201c0a190b4a71f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8733400e167adbe1a072796bfeec846"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#aa8733400e167adbe1a072796bfeec846">_dumpBucket</a> (const <a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *<a class="el" href="btree__interface_8cpp.html#ab2e2c4e065770568742b520d2cfc6fb7">bucket</a>) const</td></tr>
<tr class="memdesc:aa8733400e167adbe1a072796bfeec846"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the contents of a bucket to the log.  <a href="#aa8733400e167adbe1a072796bfeec846">More...</a><br /></td></tr>
<tr class="separator:aa8733400e167adbe1a072796bfeec846"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcceb570e3bbf2fc30664c426f8c0680"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#abcceb570e3bbf2fc30664c426f8c0680">_dumpBucketToBSON</a> (const std::map&lt; <a class="el" href="namespacemongo.html#ad7b6e5bd2d44b9b4fe9031b23492c38a">LockerId</a>, BSONObj &gt; &amp;lockToClientMap, const <a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *<a class="el" href="btree__interface_8cpp.html#ab2e2c4e065770568742b520d2cfc6fb7">bucket</a>, BSONObjBuilder *result)</td></tr>
<tr class="memdesc:abcceb570e3bbf2fc30664c426f8c0680"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the contents of a bucket to the BSON.  <a href="#abcceb570e3bbf2fc30664c426f8c0680">More...</a><br /></td></tr>
<tr class="separator:abcceb570e3bbf2fc30664c426f8c0680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef879eb6df3eaf31517c1efd868b019"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a7ef879eb6df3eaf31517c1efd868b019">_buildBucketBSON</a> (const <a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *iter, const std::map&lt; <a class="el" href="namespacemongo.html#ad7b6e5bd2d44b9b4fe9031b23492c38a">LockerId</a>, BSONObj &gt; &amp;lockToClientMap, const <a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *<a class="el" href="btree__interface_8cpp.html#ab2e2c4e065770568742b520d2cfc6fb7">bucket</a>, BSONArrayBuilder *locks)</td></tr>
<tr class="memdesc:a7ef879eb6df3eaf31517c1efd868b019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the BSON object containing the lock info for a particular bucket.  <a href="#a7ef879eb6df3eaf31517c1efd868b019">More...</a><br /></td></tr>
<tr class="separator:a7ef879eb6df3eaf31517c1efd868b019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56f9ebe7eb050f969d279fdd5c158b0f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a56f9ebe7eb050f969d279fdd5c158b0f">_onLockModeChanged</a> (<a class="el" href="structmongo_1_1LockHead.html">LockHead</a> *<a class="el" href="classmongo_1_1LockManager.html#a91ca10f4da1bffb5a0988f5affddd507">lock</a>, bool checkConflictQueue)</td></tr>
<tr class="memdesc:a56f9ebe7eb050f969d279fdd5c158b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should be invoked when the state of a lock changes in a way, which could potentially allow other blocked requests to proceed.  <a href="#a56f9ebe7eb050f969d279fdd5c158b0f">More...</a><br /></td></tr>
<tr class="separator:a56f9ebe7eb050f969d279fdd5c158b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a496c69ec3269909f3a6541c44dc73a0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a496c69ec3269909f3a6541c44dc73a0a">_cleanupUnusedLocksInBucket</a> (<a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *<a class="el" href="btree__interface_8cpp.html#ab2e2c4e065770568742b520d2cfc6fb7">bucket</a>)</td></tr>
<tr class="memdesc:a496c69ec3269909f3a6541c44dc73a0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to delete all locks that have no request on them on a single bucket.  <a href="#a496c69ec3269909f3a6541c44dc73a0a">More...</a><br /></td></tr>
<tr class="separator:a496c69ec3269909f3a6541c44dc73a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a7a9f89c5a11e8ce48644f605ee44d0c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a7a9f89c5a11e8ce48644f605ee44d0c3">_lockBuckets</a></td></tr>
<tr class="separator:a7a9f89c5a11e8ce48644f605ee44d0c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1031634f835fb8b4b730d28a59507b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmongo_1_1LockManager_1_1Partition.html">Partition</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#ae1031634f835fb8b4b730d28a59507b2">_partitions</a></td></tr>
<tr class="separator:ae1031634f835fb8b4b730d28a59507b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a4db7617c5f6095d65b7c1bd04035e0fd"><td class="memItemLeft" align="right" valign="top">static const unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#a4db7617c5f6095d65b7c1bd04035e0fd">_numLockBuckets</a></td></tr>
<tr class="separator:a4db7617c5f6095d65b7c1bd04035e0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff4c14d64bba23f8c465e54cb4661712"><td class="memItemLeft" align="right" valign="top">static const unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#aff4c14d64bba23f8c465e54cb4661712">_numPartitions</a> = 32</td></tr>
<tr class="separator:aff4c14d64bba23f8c465e54cb4661712"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:ae73dc6859447f4f9568904650dc0368a"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#ae73dc6859447f4f9568904650dc0368a">DeadlockDetector</a></td></tr>
<tr class="separator:ae73dc6859447f4f9568904650dc0368a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa839e244dd3fe7ac73c3f4c3841746ad"><td class="memItemLeft" align="right" valign="top">struct&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmongo_1_1LockManager.html#aa839e244dd3fe7ac73c3f4c3841746ad">LockHead</a></td></tr>
<tr class="separator:aa839e244dd3fe7ac73c3f4c3841746ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a244f9122cac2e35ca64106636ebf0cad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a244f9122cac2e35ca64106636ebf0cad">&#9670;&nbsp;</a></span>LockManager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mongo::LockManager::LockManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae9103fc87885ba6b3465248ad7721531"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9103fc87885ba6b3465248ad7721531">&#9670;&nbsp;</a></span>~LockManager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mongo::LockManager::~LockManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7ef879eb6df3eaf31517c1efd868b019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ef879eb6df3eaf31517c1efd868b019">&#9670;&nbsp;</a></span>_buildBucketBSON()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::_buildBucketBSON </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; <a class="el" href="namespacemongo.html#ad7b6e5bd2d44b9b4fe9031b23492c38a">LockerId</a>, BSONObj &gt; &amp;&#160;</td>
          <td class="paramname"><em>lockToClientMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BSONArrayBuilder *&#160;</td>
          <td class="paramname"><em>locks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the BSON object containing the lock info for a particular bucket. </p>
<p>The lockToClientMap is used to map the lockerId to more useful client information. </p>

</div>
</div>
<a id="a496c69ec3269909f3a6541c44dc73a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a496c69ec3269909f3a6541c44dc73a0a">&#9670;&nbsp;</a></span>_cleanupUnusedLocksInBucket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::_cleanupUnusedLocksInBucket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to delete all locks that have no request on them on a single bucket. </p>
<p>Called by <a class="el" href="classmongo_1_1LockManager.html#a335b2031ddbe964785d161345eb72d59" title="Iterates through all buckets and deletes all locks, which have no requests on them.">cleanupUnusedLocks()</a> </p>

</div>
</div>
<a id="aa8733400e167adbe1a072796bfeec846"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8733400e167adbe1a072796bfeec846">&#9670;&nbsp;</a></span>_dumpBucket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::_dumpBucket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prints the contents of a bucket to the log. </p>

</div>
</div>
<a id="abcceb570e3bbf2fc30664c426f8c0680"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcceb570e3bbf2fc30664c426f8c0680">&#9670;&nbsp;</a></span>_dumpBucketToBSON()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::_dumpBucketToBSON </td>
          <td>(</td>
          <td class="paramtype">const std::map&lt; <a class="el" href="namespacemongo.html#ad7b6e5bd2d44b9b4fe9031b23492c38a">LockerId</a>, BSONObj &gt; &amp;&#160;</td>
          <td class="paramname"><em>lockToClientMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BSONObjBuilder *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dump the contents of a bucket to the BSON. </p>

</div>
</div>
<a id="aec684525d5f75e793f2ed222f0d40664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec684525d5f75e793f2ed222f0d40664">&#9670;&nbsp;</a></span>_getBucket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockManager::LockBucket</a> * mongo::LockManager::_getBucket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmongo_1_1ResourceId.html">ResourceId</a>&#160;</td>
          <td class="paramname"><em>resId</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the bucket in which the particular resource must reside. </p>
<p>There is no need to hold a lock when calling this function. </p>

</div>
</div>
<a id="a952ef126c6788402201c0a190b4a71f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a952ef126c6788402201c0a190b4a71f9">&#9670;&nbsp;</a></span>_getPartition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmongo_1_1LockManager_1_1Partition.html">LockManager::Partition</a> * mongo::LockManager::_getPartition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieves the <a class="el" href="structmongo_1_1LockManager_1_1Partition.html">Partition</a> that a particular <a class="el" href="structmongo_1_1LockRequest.html" title="There is one of those entries per each request for a lock.">LockRequest</a> should use for intent locking. </p>

</div>
</div>
<a id="a56f9ebe7eb050f969d279fdd5c158b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56f9ebe7eb050f969d279fdd5c158b0f">&#9670;&nbsp;</a></span>_onLockModeChanged()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::_onLockModeChanged </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmongo_1_1LockHead.html">LockHead</a> *&#160;</td>
          <td class="paramname"><em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>checkConflictQueue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Should be invoked when the state of a lock changes in a way, which could potentially allow other blocked requests to proceed. </p>
<p>MUST be called under the lock bucket's mutex.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lock</td><td><a class="el" href="classmongo_1_1Lock.html">Lock</a> whose grant state should be recalculated. </td></tr>
    <tr><td class="paramname">checkConflictQueue</td><td>Whether to go through the conflict queue. This is an optimisation in that we only need to check the conflict queue if one of the granted modes, which was conflicting before became zero. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a335b2031ddbe964785d161345eb72d59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a335b2031ddbe964785d161345eb72d59">&#9670;&nbsp;</a></span>cleanupUnusedLocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::cleanupUnusedLocks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Iterates through all buckets and deletes all locks, which have no requests on them. </p>
<p>This call is kind of expensive and should only be used for reducing the memory footprint of the lock manager. </p>

</div>
</div>
<a id="ac9ca72cf163a2b891d814527f9adc042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9ca72cf163a2b891d814527f9adc042">&#9670;&nbsp;</a></span>convert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#af54347edd3ad8dc00c6c27e0816e2dea">LockResult</a> mongo::LockManager::convert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmongo_1_1ResourceId.html">ResourceId</a>&#160;</td>
          <td class="paramname"><em>resId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemongo.html#a9a3ebc0a91ee78ba95fc1ef18a948a2b">LockMode</a>&#160;</td>
          <td class="paramname"><em>newMode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8207d18c5f434eabcc9cfe4a4718853a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8207d18c5f434eabcc9cfe4a4718853a">&#9670;&nbsp;</a></span>downgrade()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::downgrade </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemongo.html#a9a3ebc0a91ee78ba95fc1ef18a948a2b">LockMode</a>&#160;</td>
          <td class="paramname"><em>newMode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Downgrades the mode in which an already granted request is held, without changing the reference count of the lock request. </p>
<p>This call never blocks, will always succeed and may potentially allow other blocked lock requests to proceed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>Request, already in granted mode through a previous call to lock. </td></tr>
    <tr><td class="paramname">newMode</td><td>Mode, which is less-restrictive than the mode in which the request is already held. I.e., the conflict set of newMode must be a sub-set of the conflict set of the request's current mode. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa3338bd7bfcbb398d628ac73860c20ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3338bd7bfcbb398d628ac73860c20ad">&#9670;&nbsp;</a></span>dump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::dump </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dumps the contents of all locks to the log. </p>

</div>
</div>
<a id="ad5b07f477174362f1596de6089d003c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5b07f477174362f1596de6089d003c6">&#9670;&nbsp;</a></span>getLockInfoBSON()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#aa639063deea016a1dac8f046e93900a6">void</a> mongo::LockManager::getLockInfoBSON </td>
          <td>(</td>
          <td class="paramtype">const std::map&lt; <a class="el" href="namespacemongo.html#ad7b6e5bd2d44b9b4fe9031b23492c38a">LockerId</a>, BSONObj &gt; &amp;&#160;</td>
          <td class="paramname"><em>lockToClientMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BSONObjBuilder *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dumps the contents of all locks into a BSON object to be used in lockInfo command in the shell. </p>

</div>
</div>
<a id="a91ca10f4da1bffb5a0988f5affddd507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91ca10f4da1bffb5a0988f5affddd507">&#9670;&nbsp;</a></span>lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemongo.html#af54347edd3ad8dc00c6c27e0816e2dea">LockResult</a> mongo::LockManager::lock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmongo_1_1ResourceId.html">ResourceId</a>&#160;</td>
          <td class="paramname"><em>resId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemongo.html#a9a3ebc0a91ee78ba95fc1ef18a948a2b">LockMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Acquires lock on the specified resource in the specified mode and returns the outcome of the operation. </p>
<p>See the details for LockResult for more information on what the different results mean.</p>
<p>Locking the same resource twice increments the reference count of the lock so each call to lock must be matched with a call to unlock with the same resource.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resId</td><td>Id of the resource to be locked. </td></tr>
    <tr><td class="paramname">request</td><td><a class="el" href="structmongo_1_1LockRequest.html" title="There is one of those entries per each request for a lock.">LockRequest</a> structure on which the state of the request will be tracked. This value cannot be NULL and the notify value must be set. If the return value is not LOCK_WAITING, this pointer can be freed and will not be used any more.</td></tr>
  </table>
  </dd>
</dl>
<p>If the return value is LOCK_WAITING, the notification method will be called at some point into the future, when the lock either becomes granted or a deadlock is discovered. If unlock is called before the lock becomes granted, the notification will not be invoked.</p>
<p>If the return value is LOCK_WAITING, the notification object <em>must</em> live at least until the notify method has been invoked or unlock has been called for the resource it was assigned to. Failure to do so will cause the lock manager to call into an invalid memory location. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>Mode in which the resource should be locked. <a class="el" href="classmongo_1_1Lock.html">Lock</a> upgrades are allowed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>See comments for LockResult. </dd></dl>

</div>
</div>
<a id="ad636a261ed7fb750564f886570c84866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad636a261ed7fb750564f886570c84866">&#9670;&nbsp;</a></span>MONGO_DISALLOW_COPYING()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mongo::LockManager::MONGO_DISALLOW_COPYING </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmongo_1_1LockManager.html">LockManager</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a28815c9331a810856b12ce10b88565fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28815c9331a810856b12ce10b88565fe">&#9670;&nbsp;</a></span>unlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mongo::LockManager::unlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmongo_1_1LockRequest.html">LockRequest</a> *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrements the reference count of a previously locked request and if the reference count becomes zero, removes the request and proceeds to granting any conflicts. </p>
<p>This method always succeeds and never blocks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>A previously locked request. Calling unlock more times than lock was called for the same <a class="el" href="structmongo_1_1LockRequest.html" title="There is one of those entries per each request for a lock.">LockRequest</a> is an error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if this is the last reference for the request; false otherwise </dd></dl>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="ae73dc6859447f4f9568904650dc0368a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae73dc6859447f4f9568904650dc0368a">&#9670;&nbsp;</a></span>DeadlockDetector</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classmongo_1_1DeadlockDetector.html">DeadlockDetector</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa839e244dd3fe7ac73c3f4c3841746ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa839e244dd3fe7ac73c3f4c3841746ad">&#9670;&nbsp;</a></span>LockHead</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend struct <a class="el" href="structmongo_1_1LockHead.html">LockHead</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7a9f89c5a11e8ce48644f605ee44d0c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a9f89c5a11e8ce48644f605ee44d0c3">&#9670;&nbsp;</a></span>_lockBuckets</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmongo_1_1LockManager_1_1LockBucket.html">LockBucket</a>* mongo::LockManager::_lockBuckets</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4db7617c5f6095d65b7c1bd04035e0fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4db7617c5f6095d65b7c1bd04035e0fd">&#9670;&nbsp;</a></span>_numLockBuckets</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned mongo::LockManager::_numLockBuckets</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aff4c14d64bba23f8c465e54cb4661712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff4c14d64bba23f8c465e54cb4661712">&#9670;&nbsp;</a></span>_numPartitions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned mongo::LockManager::_numPartitions = 32</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae1031634f835fb8b4b730d28a59507b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1031634f835fb8b4b730d28a59507b2">&#9670;&nbsp;</a></span>_partitions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmongo_1_1LockManager_1_1Partition.html">Partition</a>* mongo::LockManager::_partitions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/louis/git/mongodbsource.github.io/src/src/mongo/db/concurrency/<a class="el" href="lock__manager_8h_source.html">lock_manager.h</a></li>
<li>/home/louis/git/mongodbsource.github.io/src/src/mongo/db/concurrency/<a class="el" href="lock__manager_8cpp.html">lock_manager.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemongo.html">mongo</a></li><li class="navelem"><a class="el" href="classmongo_1_1LockManager.html">LockManager</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
